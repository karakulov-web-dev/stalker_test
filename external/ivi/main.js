/*! ivi-webapp - v2.5.19 - 2017-10-18 */
require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";b.exports=function(a,b){function c(c,g){var h=function(c,h){if(c)return d=!0,void("function"==typeof b&&b(c));if(f[g]=h,e++,e===a.length&&"function"==typeof b)b(null,f);else if(e>a.length)throw Error("done callback invoked more than one time in function with "+g+" position in tasks array")};d||(0===c.length?h(null,c()):c(h))}var d=!1,e=0,f=[];a=Array.isArray(a)?a:[],0===a.length?"function"==typeof b&&b(null,f):a.forEach(c)}},{}],"collections/adv":[function(a,b,c){b.exports=a("4eSXXB")},{}],"4eSXXB":[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={name:"AdvCollection",modelType:f,watchHistory:{},inLoad:!1},e.call(this,j.defaults(a||{},this.defaults)),this.on("add",function(a){a.model.setAll({filmId:this.filmId,watchid:this.watchid}),a.model.on("watched",function(){b.watchHistory[a.model.get("type")]=Date.now()})}),this.rpcClient=new g(i.get("contentApiUrl"),i.get("advApiNamespace"))}var e=a("lib/collection"),f=a("models/adv"),g=a("lib/rpc.client"),h=a("models/user"),i=a("../config"),j=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.getByType=function(a){return this.filter(function(b){return b.get("type")===a})},d.prototype.prepareAdvLast=function(){var a,b,c={};for(a in this.watchHistory)this.watchHistory.hasOwnProperty(a)&&(c[a]=Math.round((Date.now()-this.watchHistory[a])/1e3),b||(b=c[a]),c[a]<b&&(b=c[a]));return{lastByType:c,timeSince:b}},d.prototype.add=function(a){Array.isArray(a.files)&&a.files.length&&e.prototype.add.call(this,a)},d.prototype.load=function(a,b,c){var d,e,f=this;this.clear(),this.filmId=a,this.watchid=b,this.inLoad=!0,d=this.getParams(),e=this.prepareAdvLast(),e.timeSince&&(d.adv_last_by_type=e.lastByType,d.last_adv=e.timeSince),this.loadXhr=this.rpcClient.call("get",[this.filmId,d,c]).onSuccess(function(a){f.inLoad=!1,f.models(a),f.trigger("loaded")}).onError(function(a){f.inLoad=!1,f.trigger("loadError",a)})},d.prototype.loadMore=function(a,b,c,d){var e,f,g=this;this.clear(),this.filmId=a,this.watchid=b,this.inLoad=!0,e=this.getParams(),f=this.prepareAdvLast(),f.timeSince&&(e.adv_last_by_type=f.lastByType,e.last_adv=f.timeSince),this.loadXhr=this.rpcClient.call("get",[this.filmId,e,c]).onSuccess(function(a){g.inLoad=!1,g.models(a),d()}).onError(function(a){g.inLoad=!1,d()})},d.prototype.getParams=function(){var a={site:"s"+i.get("site"),watchid:this.watchid,uid:i.get("uid"),app_version:i.get("app_version"),session:h.get("session"),adblock:0,bandwidth:null,age:null,gender:null,previous_campaigns:{"2month":{},"3month":{},"4month":{},"5month":{},"6month":{},day:{},hour:{},month:{},week:{}},previous_orders:{"2month":{},"3month":{},"4month":{},"5month":{},"6month":{},day:{},hour:{},month:{},week:{}},previous_sites:{day:{},hour:{},month:{},week:{}},previous_videos:{"2month":{},"3month":{},"4month":{},"5month":{},"6month":{},day:{},hour:{},month:{},week:{}},session_content_ids:[],shown_campaign_ids:[],shown_order_ids:[],shown_video_ids:[],sourceid:""};return h.isAuthorized()&&(a.age=h.get("age"),a.gender=h.get("gender")),a},d.prototype.abort=function(){this.loadXhr&&this.loadXhr.abort()},b.exports=d},{"../config":40,"lib/collection":"Ou0jNv","lib/rpc.client":"PcZuZs","lib/tools":"AjqgZI","models/adv":"giot0N","models/user":"QAloAk"}],"collections/films":[function(a,b,c){b.exports=a("MRwP1A")},{}],MRwP1A:[function(a,b,c){"use strict";function d(a){this.defaults={url:g.get("apiUrl")+"/catalogue/"+g.get("apiVersion"),modelType:f,params:{from:0,to:27,direction:1},indent:12,maxLength:36},e.call(this,h.defaults(a||{},this.defaults)),this.defParams=this.params,this.on("fetch",function(a){this.params.to-this.params.from>a.length&&(this.params.to=this.params.from+a.length-1,a.to<0&&(a.to=0),this.isEnd=!0),this.updateIndexes()}),this.on("remove",function(){-1===this.params.direction&&(this.isEnd=!1)}),this.on("add",function(a){var b;a.model.index=a.index,this.length>this.maxLength&&(b=1===this.params.direction?this.slice(0,1)[0]:this.slice(-1)[0],this.remove(b))})}var e=a("lib/ajax.collection"),f=a("models/film"),g=a("../config"),h=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.clear=function(){this.emit("clear")},d.prototype.fullClear=function(){this.reset(),e.prototype.clear.call(this)},d.prototype.models=function(a){var b;if(1===this.params.direction)e.prototype.models.call(this,a);else{for(var c=a.length-1;c>=0;c--)b=this.insert(a[c],0),b.view.hide();this.clear()}},d.prototype.updateIndexes=function(){for(var a=0;a<this.length;a++)this._data[a].index=a},d.prototype.sort=function(a){this.params.sort=a,this.fetch()},d.prototype.reset=function(){this.setParameters(this.defParams)},b.exports=d},{"../config":40,"lib/ajax.collection":"fqWis0","lib/tools":"AjqgZI","models/film":"DKEUaB"}],"7uhHY+":[function(a,b,c){"use strict";function d(a){this.defaults={url:g.get("apiUrl")+"/promo/"+g.get("apiVersion"),params:{},autoload:!0,modelType:f},e.call(this,h.defaults(a||{},this.defaults)),this.imageSize="372x163"}var e=a("lib/ajax.collection"),f=a("models/promo"),g=a("../config"),h=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d},{"../config":40,"lib/ajax.collection":"fqWis0","lib/tools":"AjqgZI","models/promo":"iVIYTP"}],"collections/promo":[function(a,b,c){b.exports=a("7uhHY+")},{}],"collections/reviews":[function(a,b,c){b.exports=a("RbgBjM")},{}],RbgBjM:[function(a,b,c){"use strict";function d(a){this.defaults={url:g.get("apiUrl")+"/video/reviews",params:{limit:5,sort:"all"},autoLoad:!1,events:{add:function(a){a.model.get("text")!==a.model.get("moderate_preview")&&a.model.set("isPreview",!0)}}},e.call(this,f.defaults(a||{},this.defaults))}var e=a("lib/ajax.collection"),f=a("lib/tools"),g=a("../config");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setType=function(a){this.url=g.get("apiUrl")+"/"+a+"/reviews"},d.prototype.fetch=function(a){this.params.id=a,e.prototype.fetch.call(this)},b.exports=d},{"../config":40,"lib/ajax.collection":"fqWis0","lib/tools":"AjqgZI"}],uboD1Q:[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={url:g.get("apiUrl")+"/videofromcompilation/",modelType:f,params:{from:0,to:99},view:{watch:!0},maxLength:100,allLoaded:!1},e.call(this,h.defaults(a||{},this.defaults)),this.on("fetch",function(a){if(a.length===b.maxLength){var c=b.getParameter("from"),d=b.getParameter("to");b.setParameter("from",c+b.maxLength),b.setParameter("to",d+b.maxLength),b.merge()}else b.allLoaded=!0})}var e=a("lib/ajax.collection"),f=a("models/serie"),g=a("../config"),h=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.fullClear=function(){this.reset(),e.prototype.clear.call(this)},d.prototype.reset=function(){this.setParameters(this.defParams)},b.exports=d},{"../config":40,"lib/ajax.collection":"fqWis0","lib/tools":"AjqgZI","models/serie":"jiRtAe"}],"collections/series":[function(a,b,c){b.exports=a("uboD1Q")},{}],"components/action":[function(a,b,c){b.exports=a("tNzK7p")},{}],tNzK7p:[function(a,b,c){"use strict";function d(a){this.defaults={name:"CAction"},e.call(this,f.defaults(a,this.defaults)),this.on("click",function(){"function"==typeof this.action&&this.action()})}var e=a("lib/cbase"),f=a("lib/tools"),g=a("lib/keys");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.eventHandler=function(a){switch(a.code){case g.OK:return this.emit("click"),!0}return!1},b.exports=d},{"lib/cbase":"tTNRm4","lib/keys":"iIRFqq","lib/tools":"AjqgZI"}],"+xiQfc":[function(a,b,c){"use strict";function d(a){this.defaults={name:"CButton",model:{data:{title:a.title||""},view:{template:void 0!==a.template?a.template:!0,watch:a.watch,handle:a.handle}}},e.call(this,f.defaults(a,this.defaults))}var e=a("components/action"),f=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setTitle=function(a){this.model.set("title",a)},b.exports=d},{"components/action":"tNzK7p","lib/tools":"AjqgZI"}],"components/button":[function(a,b,c){b.exports=a("+xiQfc")},{}],SHo47G:[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={visible:!0,name:"Footer",handle:null,manager:null,active:!1,owner:null,model:{data:{isLoading:!0,buttonsVisible:!1}},viewType:f,view:{template:!0,watch:!0,autoRender:!0}},e.call(this,h.defaults(a,this.defaults)),this.list=new g({name:"FooterButtons",arrows:null,visible:!1,handle:this.handle.querySelector(".buttons-list"),active:!0,collection:{watch:!0,idName:"button",data:[{title:"Выход",button:"exit",code:i.EXIT},{title:"Подробнее",button:"info",code:i.INFO},{title:"Изменить вид",button:"frame",code:i.FRAME},{button:"red",code:i.F1},{button:"green",code:i.F2},{button:"yellow",code:i.F3},{button:"blue",code:i.F4}],events:{models:function(a){for(var b,c=0;b=a.models[c];c++)b.view.hide()}}},events:{enter:function(a){b.owner.emit("keydown",{code:a.get("code")})}}})}var e=a("lib/cbase"),f=a("lib/model.view"),g=a("components/hlist"),h=a("lib/tools"),i=a("lib/keys");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.loading=function(a){this.model.set("isLoading",a)},d.prototype.buttons=function(a){a?this.list.show():this.list.hide()},d.prototype.showButton=function(a,b){a=this.list.collection.get(a),a&&a.view.show(),b&&a.set("title",b)},d.prototype.hideButton=function(a){a=this.list.collection.get(a),a&&a.view.hide()},d.prototype.hideAll=function(){this.list.collection.forEach(function(a){a.view.hide()})},d.prototype.setTitle=function(a,b){a=this.list.collection.get(a),a&&a.set("title",b)},b.exports=d},{"components/hlist":"GEj0De","lib/cbase":"tTNRm4","lib/keys":"iIRFqq","lib/model.view":"ESYGw6","lib/tools":"AjqgZI"}],"components/footer":[function(a,b,c){b.exports=a("SHo47G")},{}],"zExk/C":[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={visible:!0,name:"Header",handle:null,manager:null,active:!1,owner:null,model:{data:{title:"",logoPosition:"center",menuShow:!0}},viewType:g,view:{template:!0,watch:!0,autoRender:!0}},e.call(this,h.defaults(a,this.defaults)),this.on("activate",function(){b.manager.current().deactivate()}),this.addComponent(new f({handle:document.getElementById("header-menu-btn"),active:!0,owner:this,action:function(){b.owner.showMenu()}}))}var e=a("lib/cpanel"),f=a("components/button"),g=a("lib/model.view"),h=a("lib/tools"),i=a("lib/keys");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setTitle=function(a){a?(this.model.set("title",a),this.model.set("logoPosition","right")):(this.model.remove("title"),this.model.set("logoPosition","center"))},d.prototype.eventHandler=function(a){switch(a.code){case i.UP:return!0;case i.DOWN:case i.EXIT:return this.manager.current().activate(),!0}return e.prototype.eventHandler.call(this,a)},b.exports=d},{"components/button":"+xiQfc","lib/cpanel":"ySbxUr","lib/keys":"iIRFqq","lib/model.view":"ESYGw6","lib/tools":"AjqgZI"}],"components/header":[function(a,b,c){b.exports=a("zExk/C")},{}],"components/hflist":[function(a,b,c){b.exports=a("qh3oth")},{}],qh3oth:[function(a,b,c){"use strict";function d(a){this.defaults={name:"FilmsList",activated:!0,autoLoad:!0,collection:{params:{sort:a.sort}},collectionType:f},e.call(this,g.defaults(a,this.defaults)),this.autoLoad===!0&&this.collection.fetch()}var e=a("./hlist"),f=a("collections/films"),g=a("lib/tools"),h=a("lib/keys"),i=a("lib/dom");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.moveNext=function(){var a,b,c=this.activeChild||this.first();this.collection.length-c.index<this.collection.indent&&this.collection.fetching===!1&&this.collection.isEnd!==!0&&(a=this.collection.params,b=-1===a.direction?this.collection.length:this.collection.indent,a.to+=b,a.from=a.to-this.collection.indent+1,a.direction=1,this.collection.fetch()),e.prototype.moveNext.call(this)},d.prototype.movePrevious=function(){var a,b,c=this.activeChild||this.first();a=this.collection.params,c.index<this.collection.indent&&0!==a.from&&this.collection.fetching===!1&&(b=1===a.direction?this.collection.length:this.collection.indent,a.to-=b,a.from=a.to-this.collection.indent+1,a.from<0&&(a.from=0),a.direction=-1,this.collection.fetch()),e.prototype.movePrevious.call(this)},d.prototype.updateArrows=function(a){this.arrows&&a&&(0===a.index&&0===this.collection.getParameter("from")&&this.collection.fetching!==!0?(i.hide(this.arrows.previous),i.show(this.arrows.next)):this.collection.indexOf(a)===this.collection.length-1&&this.collection.isEnd===!0?(i.hide(this.arrows.next),i.show(this.arrows.previous)):(i.show(this.arrows.next),i.show(this.arrows.previous)))},d.prototype.reload=function(){this.collection.fullClear(),this.collection.fetch(),this.activeChild=null},d.prototype.eventHandler=function(a){switch(a.code){case h.INFO:return this.emit("showInfo",this.activeChild),!0}return e.prototype.eventHandler.call(this,a)},d.prototype.sortBy=function(a){this.collection.once("clear",function(){this.fullClear()}),this.collection.reset(),this.collection.params.sort=a,this.collection.fetch(),this.activeChild=null},b.exports=d},{"./hlist":"GEj0De","collections/films":"MRwP1A","lib/dom":"CBUzS7","lib/keys":"iIRFqq","lib/tools":"AjqgZI"}],GEj0De:[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={},e.call(this,f.defaults(a,this.defaults)),this._last=null,this._first=null,this.on("activate",function(){this._update()}),this.collection.on("fetch",function(){b._update()})}var e=a("./list"),f=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.moveNext=function(){var a=this.next();null!==a&&(this.activeChild===this._last&&(this.hideItem(this._first),this._first=this.next(this._first),this._last=a),this.activateItem(a))},d.prototype.movePrevious=function(){var a=this.previous();null!==a&&(this.activeChild===this._first&&(this._first=this.previous(this._first),this.showItem(this._first),this._last=this.previous(this._last)),this.activateItem(a))},d.prototype._update=function(){var a=0,b=this.collection.view.handle.firstElementChild;for(this._last=null,this._first=null;b&&(this.filter(b)&&b.view.isVisible()&&(null===this._first&&(this._first=b.view.model),a++,this._last=b.view.model),a!==this.hItems);)b=b.nextElementSibling},b.exports=d},{"./list":"ZuDVNd","lib/tools":"AjqgZI"}],"components/hlist":[function(a,b,c){b.exports=a("GEj0De")},{}],"7zX6co":[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={name:"CInput",handle:null},e.call(this,h.defaults(a,this.defaults)),this.on("activate",function(){b.handle.focus()}),this.on("deactivate",function(){b.handle.blur()}),this.handle.addEventListener("input",function(){b.emit("change",b.value)}),this.on("change",function(){b.handle.blur(),b.handle.focus()}),f.on("keydown",function(a){a.code===g.BACK&&document.activeElement===b.handle&&b.remove()})}var e=a("lib/cbase"),f=a("lib/listener"),g=a("lib/keys"),h=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.blur=function(){this.handle.blur()},d.prototype.focus=function(){this.handle.focus()},d.prototype.clear=function(){this.handle.value=""},d.prototype.insert=function(a){var b=this.handle.value.split(""),c=this.handle.selectionStart;b.splice(c,0,a),this.handle.value=b.join(""),this.setCaretTo(c+1),this.emit("change",this.handle.value)},d.prototype.remove=function(){var a=this.handle.value.split(""),b=this.handle.selectionStart,c=this.handle.selectionEnd;b===c?a.splice(b-1,1):a.splice(b-1,b-c),this.handle.value=a.join(""),this.emit("change",this.handle.value)},d.prototype.carriageLeft=function(){this.handle.selectionStart--,this.handle.selectionEnd--},d.prototype.carriageRight=function(){this.handle.selectionEnd++,this.handle.selectionStart++},d.prototype.setCaretTo=function(a){this.handle.selectionStart=a,this.handle.selectionEnd=a},d.prototype.eventHandler=function(a){switch(a.code){case g.LEFT:return this.carriageLeft(),0!==this.handle.selectionStart;case g.RIGHT:return this.carriageRight(),this.handle.selectionStart===this.handle.selectionEnd&&this.handle.selectionStart!==this.handle.value.length}return!1},Object.defineProperties(d.prototype,{value:{get:function(){return this.handle.value}}}),b.exports=d},{"lib/cbase":"tTNRm4","lib/keys":"iIRFqq","lib/listener":"0gs5AI","lib/tools":"AjqgZI"}],"components/input":[function(a,b,c){b.exports=a("7zX6co")},{}],A64hEq:[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={name:"Keyboard",arrows:null,active:!0,activated:!0,scroller:!1,input:null,collection:{modelType:f,watch:!0},keymap:{value:"Рус","short":"ru"},textCase:"lower"},e.call(this,g.defaults(a,this.defaults)),this.initCollection(),this.on("activateItem",function(a){"skip"===a.get("class")&&b.moveNext()}),this.on("previous",function(a){a.skip||"Очистить"!==a.item.get("value")||(a.skip=2)}),this.on("enter",function(a){"function"==typeof a.data.action&&a.data.action(a)})}var e=a("components/mclist"),f=a("lib/model"),g=a("lib/tools"),h={ru:["а","б","в","г","д","е","ё","ж","з","и","й","к","л","м","н","о","п","р","с","т","у","ф","х","ц","ч","ш","щ","ъ","ы","ь","э","ю","я"],en:["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],ch:["1","2","3","4","5","6","7","8","9","0",".",",","-",":","(",")","$","&",'"',"!","?","@","/","\\","'","+","*","_"]};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.initCollection=function(){var a,b,c=this,d=[{type:"control",action:function(){c.input.remove()},"class":"del"},{type:"control",action:function(){c.input.carriageLeft()},"class":"left"},{type:"control",action:function(){c.input.carriageRight()},"class":"right"},{type:"control",action:function(a){c.changeKeymap(a)},"class":"serv",value:"Eng","short":"en"},{type:"control",action:function(a){c.changeKeymap(a)},"class":"serv",value:"123","short":"ch"},{type:"control","class":"skip"},{type:"control",action:function(){c.input.clear()},"class":"serv wide",value:"Очистить"}],e=function(a){c.addChar(a)};for(b in h)if(h.hasOwnProperty(b))for(a=0;a<h[b].length;a++)d.push({value:h[b][a],type:b,action:e,"class":"symbol"});d.push({type:"control",action:e,"class":"space",value:" "}),d.push({type:"control",action:function(a){c.changeCase(a)},"class":"shift",id:"shift"}),this.collection.models(d)},d.prototype.changeCase=function(a){var b,c=this;this.textCase="upper"===this.textCase?"lower":"upper",this.collection.forEach(function(a){b=a.get("value"),"string"==typeof b&&"control"!==a.get("type")&&(b="upper"===c.textCase?b.toUpperCase():b.toLowerCase(),a.set("value",b))}),a.set("class","shift "+this.textCase)},d.prototype.changeKeymap=function(a){var b=a.getAll(),c=this.collection.get("shift");a.setAll(this.keymap),this.keymap=b,this.update(),"ch"!==this.keymap["short"]?c.view.show():c.view.hide()},d.prototype.filter=function(a){var b=a.get("type");return b===this.keymap["short"]||"control"===b},d.prototype.addChar=function(a){this.input.insert(a.get("value"))},d.prototype.previous=function(a,b){return this.activeChild.view.handle.offsetLeft<this.itemWidth&&!b?null:e.prototype.previous.call(this,a,b)},b.exports=d},{"components/mclist":"mKkleD","lib/model":"blv/2e","lib/tools":"AjqgZI"}],"components/keyboard":[function(a,b,c){b.exports=a("A64hEq")},{}],"components/list":[function(a,b,c){b.exports=a("ZuDVNd")},{}],ZuDVNd:[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={collection:{view:{handle:a.collectionHandle||a.handle,template:!0,watch:!0}},arrows:{previous:".arrow.left",next:".arrow.right"},collectionType:f,activateOnHover:!1,owner:null,handle:null,scroller:!1},e.call(this,h.defaults(a,this.defaults)),this.on("activate",function(){this.activeChild||this.activateItem(this.first())}),this.activateOnHover&&this.handle.addEventListener("mouseover",function(a){b.emit("hover",a),b.activate()}),this.data=this.collection.data,delete this.collection.data,this.setCollection(this.collection),this.scroller&&this.setScroller(this.scroller),this.collection.on("add",function(a){b.activateOnHover&&a.model.view.handle.addEventListener("mouseover",function(){b.isActive()&&b.activateItem(a.model)}),b.filter(a.model)||a.model.view.hide()}),this.collection.on("request",function(){b.emit("request")}),this.collection.on("fetch",function(){b.emit("fetch"),b.activeChild||b.activateItem(b.collection.at(0))}),this.arrows&&this.setArrows(this.arrows),this.data&&this.collection.models(this.data)}var e=a("lib/cbase"),f=a("lib/collection"),g=a("lib/scroller"),h=a("lib/tools"),i=a("lib/keys"),j=a("lib/dom");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.first=function(){if(this.collection.length){var a=(this.collectionHandle||this.handle).firstElementChild.view.model;return("function"==typeof this.parse&&!this.parse(a)||!a.view.isVisible())&&(a=this.next(a)),a}},d.prototype.next=function(a,b){if(a=a||this.activeChild,!a)return this.first();var c,d=1;for(this.emit("next",c={item:a,skip:b,next:a.view.handle.nextElementSibling});c.next;){if(this.filter(c.next.view.model)&&!this.skip(c.next.view.model)&&(!c.skip||c.skip===d++))return c.next.view.model;c.next=c.next.nextElementSibling}return null},d.prototype.previous=function(a,b){if(a=a||this.activeChild,!a)return null;var c,d=1;for(this.emit("previous",c={item:a,skip:b,previous:a.view.handle.previousElementSibling});c.previous;){if(this.filter(c.previous.view.model)&&!this.skip(c.previous.view.model)&&(!c.skip||c.skip===d++))return c.previous.view.model;c.previous=c.previous.previousElementSibling}return null},d.prototype.moveNext=function(a){var b=this.next(null,a);return null===b?!1:(this.activateItem(b),b)},d.prototype.movePrevious=function(a){var b=this.previous(null,a);return null===b?!1:(this.activateItem(b),b)},d.prototype.setArrows=function(a){var b=this;"string"==typeof a.previous&&(a.previous=this.handle.querySelector(a.previous)),"string"==typeof a.next&&(a.next=this.handle.querySelector(a.next)),a.previous.addEventListener("click",function(){b.movePrevious()}),a.next.addEventListener("click",function(){b.moveNext()})},d.prototype.updateArrows=function(a){this.arrows&&a&&(0===this.collection.indexOf(a)?(j.hide(this.arrows.previous),j.show(this.arrows.next)):this.collection.indexOf(a)===this.collection.length-1?(j.hide(this.arrows.next),j.show(this.arrows.previous)):(j.show(this.arrows.next),j.show(this.arrows.previous)))},d.prototype.setCollection=function(a){a instanceof f||(a=new this.collectionType(a)),a.owner=this,this.collection=a},d.prototype.setScroller=function(a){a instanceof g||(a=new g(this.scroller)),this.scroller=a},d.prototype.activateItem=function(a){a&&(this.deactivateItem(this.activeChild),this.scroller&&this.scroller.show(a.view.handle),a.view.handle.classList.add("active"),this.updateArrows(a),this.activeChild=a,this.emit("activateItem",a))},d.prototype.deactivateItem=function(a){a&&(this.activeChild=null,a.view.handle.classList.remove("active"),this.emit("deactivateItem",a))},d.prototype.hideItem=function(a){a&&a.view.hide()},d.prototype.showItem=function(a){a&&a.view.show()},d.prototype.filter=function(){return!0},d.prototype.skip=function(){return!1},d.prototype.update=function(){var a=this;this.collection.forEach(function(b){a.filter(b)?b.view.show():b.view.hide()})},d.prototype.clear=function(){this.collection.clear()},d.prototype.eventHandler=function(a){if(0===this.collection.length)return!1;switch(a.code){case i.RIGHT:return this.moveNext(),this.emit("right"),!0;case i.LEFT:return this.movePrevious(),this.emit("left"),!0;case i.OK:return this.emit("enter",this.activeChild),!0;case i.INFO:return this.emit("showInfo",this.activeChild),!0}return!1},Object.defineProperties(d.prototype,{hItems:{get:function(){if(this._hItems)return this._hItems;var a=this.first();return a?this._hItems=Math.floor(this.collection.view.handle.offsetWidth/a.view.handle.offsetWidth):this._hItems=0,this._hItems},set:function(a){this._hItems=a}},vItems:{get:function(){if(this._vItems)return this._vItems;var a=this.first();return a?this._vItems=Math.floor(this.collection.view.handle.offsetHeight/a.view.handle.offsetHeight):this._vItems=0,this._vItems},set:function(a){this._vItems=a}},itemHeight:{get:function(){var a=this.first();return a?a.view.handle.offsetHeight:0}},itemWidth:{get:function(){var a=this.first();return a?a.view.handle.offsetWidth:0}}}),b.exports=d},{"lib/cbase":"tTNRm4","lib/collection":"Ou0jNv","lib/dom":"CBUzS7","lib/keys":"iIRFqq","lib/scroller":"8+NRr9","lib/tools":"AjqgZI"}],"components/mcflist":[function(a,b,c){b.exports=a("gQ4GYy")},{}],gQ4GYy:[function(a,b,c){"use strict";function d(a){this.defaults={name:"MCFList",collectionType:f},e.call(this,g.defaults(a,this.defaults))}var e=a("components/mclist"),f=a("collections/films"),g=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.moveNext=function(a){var b,c,d=this.collection.params,f=this.activeChild||this.first();this.collection.length-f.index<this.collection.indent&&this.collection.fetching===!1&&this.collection.isEnd!==!0&&(b=-1===d.direction?this.collection.length:this.collection.indent,d.to+=b,d.from=d.to-this.collection.indent+1,d.direction=1,this.collection.fetch()),c=Math.floor((f.index+(a||1))/this.hItems),this.currentRow>0&&c-this.lastHiddenRow>this.hItems&&this.hideRow(this.currentRow-1),e.prototype.moveNext.call(this,a)},d.prototype.movePrevious=function(a){var b,c,d=this.collection.params,f=this.activeChild||this.first();f.index<this.collection.indent&&0!==d.from&&this.collection.fetching===!1&&(b=1===d.direction?this.collection.length:this.collection.indent,d.to-=b,d.from=d.to-this.collection.indent+1,d.from<0&&(d.from=0),d.direction=-1,this.collection.fetch()),c=Math.floor((f.index-(a||1))/this.hItems),c===this.lastHiddenRow&&this.showRow(this.lastHiddenRow),e.prototype.movePrevious.call(this,a)},d.prototype.hideRow=function(a){var b,c,d=a*this.hItems,e=d+this.hItems;for(b=d;e>b;b++)c=this.collection.at(b),c.view.hide()},d.prototype.showRow=function(a){var b,c,d=a*this.hItems,e=d+this.hItems;for(b=d;e>b;b++)c=this.collection.at(b),c.view.show()},Object.defineProperty(d.prototype,"currentRow",{get:function(){var a=this.activeChild||this.first();return Math.floor(a.index/this.hItems)}}),Object.defineProperty(d.prototype,"lastHiddenRow",{get:function(){var a=this.collection.filter(function(a){return!a.view.isVisible()}).pop();return a?Math.floor(a.index/this.hItems):-1}}),b.exports=d},{"collections/films":"MRwP1A","components/mclist":"mKkleD","lib/tools":"AjqgZI"}],mKkleD:[function(a,b,c){"use strict";function d(a){this.defaults={scroller:{container:a.collectionHandle}},e.call(this,f.defaults(a,this.defaults))}var e=a("components/list"),f=a("lib/tools"),g=a("lib/keys");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.eventHandler=function(a){switch(a.code){case g.LEFT:return this.emit("left"),this.movePrevious()!==!1;case g.RIGHT:return this.emit("right"),this.moveNext()!==!1;case g.DOWN:return this.emit("down"),this.moveNext(this.hItems)!==!1;case g.UP:return this.emit("up"),this.movePrevious(this.hItems)!==!1;case g.OK:return this.emit("enter",this.activeChild),!0;default:return!1}},b.exports=d},{"components/list":"ZuDVNd","lib/keys":"iIRFqq","lib/tools":"AjqgZI"}],"components/mclist":[function(a,b,c){b.exports=a("mKkleD")},{}],iHD9HF:[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={modal:!0,visible:!1,submenu:!1,handle:document.getElementById("menu"),menuHandle:document.getElementById("menu-list"),subMenuHandle:document.getElementById("submenu-list"),menuListHandle:document.getElementById("genres-list"),subMenuListHandle:document.getElementById("categories-list")},e.call(this,j.defaults(a,this.defaults)),this.on("show",function(){this.activate(),this.categoriesList.activeChild||this.categoriesList.activateItem(this.categoriesList.first())}),this.on("hide",function(){this.deactivate()}),this.categoriesList=new f({name:"MenuCategoryList",active:!0,owner:this,handle:this.menuHandle,arrows:{next:".arrow_bottom",previous:".arrow_top"},collection:{modelType:h},eventHandler:function(a){if(0===this.collection.length)return!1;switch(a.code){case k.RIGHT:return b.genresList.isVisible()&&b.genresList.activate(),!0}return f.prototype.eventHandler.call(this,a)},skip:function(a){return"divider"===a.get("type")},events:{enter:function(a){var c=a.get("action");b.hide(),"function"==typeof c?c():b.emit("enter",{category:a.get("id")})},activateItem:function(a){clearTimeout(this.changeTimer),this.changeTimer=setTimeout(function(){var c=a.view.model.get("genres");c?(b.genresList.collection.models(c),b.genresList.show()):b.genresList.hide()},400)}},collectionHandle:this.menuListHandle}),this.genresList=new f({name:"MenuGenreList",active:!1,visible:!1,owner:this,handle:this.subMenuHandle,scroller:{container:this.subMenuHandle,indent:30},arrows:{next:".arrow_bottom",previous:".arrow_top"},collection:{modelType:h,events:{clear:function(){b.genresList.activeChild=null}}},eventHandler:function(a){if(0===this.collection.length)return!1;switch(a.code){case k.LEFT:return b.categoriesList.activate(),!0}return f.prototype.eventHandler.call(this,a)},events:{enter:function(a){b.hide(),b.emit("enter",{genre:a.get("id")})},activate:function(){this.isVisible()||this.show()}},collectionHandle:this.subMenuListHandle}),i.categories.length?this.initMenu(i.categories.getData()):i.categories.on("fetch",function(a){b.initMenu(a)}),g.on("authorized",function(){var a=[],c=b.categoriesList.collection.get("auth"),d=c.get("firstname"),e=c.get("lastname");d&&a.push(d),e&&a.push(e),0===a.length&&a.push("Профиль"),c.set("title",a)}),g.on("logout",function(){var a=b.categoriesList.collection.get("auth");a.set("title","Авторизация")})}var e=a("lib/cbase"),f=a("components/vlist"),g=a("models/user"),h=a("lib/model"),i=a("../dictionary"),j=a("lib/tools"),k=a("lib/keys");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.initMenu=function(a){var b=this,c=[{title:"Главная",action:function(){b.emit("showMain")}}];c=c.concat(a),c=c.concat([{title:"Поиск",action:function(){b.emit("showSearch")}},{type:"divider",title:""},{id:"auth",title:"Авторизация",action:function(){b.emit("showAuthorization")}},{type:"divider",title:""},{title:"Соглашение",action:function(){b.emit("showAgreements")}},{title:"Выход",action:function(){b.emit("exit")}}]),this.categoriesList.collection.models(c)},d.prototype.eventHandler=function(a){if(this.activeChild&&"function"==typeof this.activeChild.eventHandler&&this.activeChild.eventHandler(a)===!0)return!0;switch(a.code){case k.EXIT:case k.MENU:this.hide()}return!0},b.exports=d},{"../dictionary":41,"components/vlist":"CJRc+3","lib/cbase":"tTNRm4","lib/keys":"iIRFqq","lib/model":"blv/2e","lib/tools":"AjqgZI","models/user":"QAloAk"}],"components/menu":[function(a,b,c){b.exports=a("iHD9HF")},{}],uFvIi8:[function(a,b,c){"use strict";function d(a){this.defaults={viewType:f,activated:!0,modal:!0,model:{},modelType:g,visible:!1,view:{template:!0,autoRender:!1}},e.call(this,h.defaults(a,this.defaults)),this.view.compile(),this.view.insert(this.view.compiled.element),this.on("hide",function(){this.deactivate()})}var e=a("lib/cbase"),f=a("lib/model.view"),g=a("models/film.info"),h=a("lib/tools"),i=a("lib/keys");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.show=function(a){this.film=a,this.update(a),this.handle.firstElementChild.scrollTop=0,this.view.show(),this.activate()},d.prototype.update=function(a){
this.model.clear(),this.model.setAll(a.getAll()),this.view.update()},d.prototype.eventHandler=function(a){switch(a.code){case i.UP:this.handle.firstElementChild.scrollByLines(-1);break;case i.DOWN:this.handle.firstElementChild.scrollByLines(1);break;case i.OK:this.hide(),this.emit("enter",this.film);break;case i.EXIT:case i.INFO:this.hide()}return!0},b.exports=d},{"lib/cbase":"tTNRm4","lib/keys":"iIRFqq","lib/model.view":"ESYGw6","lib/tools":"AjqgZI","models/film.info":"7L3aGG"}],"components/quickinfo":[function(a,b,c){b.exports=a("uFvIi8")},{}],"CJRc+3":[function(a,b,c){"use strict";function d(a){this.defaults={scroller:{container:a.collectionHandle}},e.call(this,f.defaults(a,this.defaults))}var e=a("components/list"),f=a("lib/tools"),g=a("lib/keys");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.eventHandler=function(a){switch(a.code){case g.DOWN:return this.moveNext()!==!1;case g.UP:return this.movePrevious()!==!1;case g.OK:return this.emit("enter",this.activeChild),!0;default:return!1}},b.exports=d},{"components/list":"ZuDVNd","lib/keys":"iIRFqq","lib/tools":"AjqgZI"}],"components/vlist":[function(a,b,c){b.exports=a("CJRc+3")},{}],40:[function(a,b,c){"use strict";var d=a("lib/local.model");b.exports=new d({name:"Ivi.ru",data:{apiUrl:"http://www.ivi.ru/mobileapi",apiUrlNew:"https://api.ivi.ru/mobileapi",contentApiUrl:"https://api.ivi.ru/light/",logApiUrl:"http://api.digitalaccess.ru/logger/",log2ApiUrl:"http://logger.ivi.ru/logger/",paidTypes:["AVOD"],apiVersion:"v3",videoMode:"576i",subtitlesFont:"/usr/lib/fonts/Ubuntu.ttf",subtitlesLang:"ru",audioLang:"ru",contentApiNamespace:"da.content",advApiNamespace:"da.adv",site:127,posterSize:"172x264",serialThumbSize:"132x95",videoQuality:"hi",deviceModel:gSTB.GetDeviceModel(),app_version:2642,signKeyK:"423725fefc39c8789910b1aed2109c80",signKeyK1:"40b5bc8bbd42b3e7",signKeyK2:"816b79177a8567ce",session:""},savedFields:["email","password","uid","videoQuality"]})},{"lib/local.model":"ieUPCh"}],41:[function(a,b,c){"use strict";var d=a("lib/ajax.collection"),e=a("lib/collection"),f=a("./config"),g=f.get("apiUrl"),h={genres:new e({})};h.init=function(a){h.countries=new d({url:g+"/countries/",parse:function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push({id:b,title:a[b]});return c},autoload:!0}),h.categories=new d({url:g+"/categories/v2/",events:{fetch:function(b){var c;for(c=0;c<b.length;c++)b[c].genres&&b[c].genres.length&&h.genres.addAll(b[c].genres);"function"==typeof a&&(a(),a=null)}},autoload:!0})},b.exports=h},{"./config":40,"lib/ajax.collection":"fqWis0","lib/collection":"Ou0jNv"}],42:[function(a,b,c){"use strict";function d(){var a,b=this,c={name:"IVI",pageManager:{showDetails:function(a){a&&b.detailsPage.show(a)},showInfo:function(a){b.quickInfo.show(a)},showSorted:function(a){b.sortedPage.show(a)},showUserData:function(a){b.profilePage.show(a)},showRatingSort:function(a,c){b.sortRatingModal.action=c,b.sortRatingModal.show(a)},showBudgetSort:function(a,c){b.sortBudgetModal.action=c,b.sortBudgetModal.show(a)},events:{allReady:function(){b.footer.handle.getElementsByClassName("loadingVersion")[0].style.display="none",b.splashScreen.hide()},startChanges:function(){b.splashScreen.show()}}},images:[]};f.call(this,c),this.authModal=new s({owner:this,handle:document.getElementById("authorization-modal")}),this.header=new m({name:"Header",owner:this,activated:!1,manager:this.pageManager,handle:document.getElementById("header")}),this.footer=new n({name:"Footer",owner:this,activated:!1,manager:this.pageManager,handle:document.getElementById("footer")}),this.quickInfo=new u({owner:this,modal:!0,handle:document.getElementById("quick-info"),events:{enter:function(a){b.pageManager.showDetails(a)},show:function(){b.footer.setTitle("info","Скрыть")},hide:function(){b.footer.setTitle("info","Подробней")}}}),this.menu=new o({owner:this,events:{enter:function(a){this.deactivate(),b.genrePage.show(a)},showAgreements:function(){b.agreementsPage.show()},showMain:function(){b.mainPage.show()},showSearch:function(){b.searchPage.show()},showAuthorization:function(){x.isAuthorized()===!1?b.authModal.show():b.profilePage.show()},exit:function(){b.exit()}}}),this.splashScreen=new p({name:"SplashScreen",handle:document.getElementById("splash-screen"),owner:this,visible:!0,active:!0,modal:!0,header:this.header,footer:this.footer,show:function(){b.footer.loading(!0),b.footer.buttons(!1),this.activate(),this.handle.classList.remove("invisible")},hide:function(){b.footer.loading(!1),b.footer.buttons(!0),this.deactivate(),this.handle.classList.add("invisible")},manager:this.pageManager,eventHandler:function(a){var c;return a.code===A.EXIT&&(c=b.pageManager.current(),c&&"function"==typeof c.cancel&&c.cancel(),this.hide(),b.pageManager.back()),!0}}),this.mainPage=this.pageManager.main(new g({visible:!0,active:!0,manager:this.pageManager,infoFilm:this.quickInfo,handle:document.getElementById("main-page"),header:this.header,footer:this.footer})),this.mainPage.on("mainPageReady",function(){y.load()}),this.detailsPage=this.pageManager.addPage(new t({manager:this.pageManager,handle:document.getElementById("details-page"),events:{showPlayer:function(a){b.playerPage.show(a)}},header:this.header,footer:this.footer})),this.genrePage=this.pageManager.addPage(new h({manager:this.pageManager,infoFilm:this.quickInfo,handle:document.getElementById("genre-page"),header:this.header,footer:this.footer})),this.playerPage=this.pageManager.addPage(new v({manager:this.pageManager,handle:document.getElementById("player-page"),header:this.header,footer:this.footer,events:{error:function(a){this.manager.back(),b.splashScreen.hide(),b.showError(a)},updateHistory:function(){x.isAuthorized()&&(b.mainPage.updateHistory(),b.profilePage.updateHistory())}}})),this.agreementsPage=this.pageManager.addPage(new k({header:this.header,footer:this.footer,manager:this.pageManager,handle:document.getElementById("agreements-page")})),this.searchPage=this.pageManager.addPage(new i({active:!0,manager:this.pageManager,handle:document.getElementById("search-page"),header:this.header,footer:this.footer})),this.profilePage=this.pageManager.addPage(new j({active:!0,manager:this.pageManager,handle:document.getElementById("profile-page"),header:this.header,footer:this.footer})),this.sortedPage=this.pageManager.addPage(new l({active:!0,manager:this.pageManager,handle:document.getElementById("sorted-page"),quickInfo:this.quickInfo,header:this.header,footer:this.footer})),a=document.getElementById("exit-modal"),this.exitModal=new p({owner:this,handle:a,visible:!1,active:!1,template:!1,exitBtnHandle:".close",buttonsHandle:".buttons",buttons:[this.exitBtn=new r({handle:a.querySelector(".btn_modal.exit"),template:!1,active:!0,action:function(){w.stop(),window.location=z.getUrlParameters("referrer")}}),new r({handle:a.querySelector(".btn_modal.cancel"),template:!1,action:function(){b.exitModal.hide()}})],events:{show:function(){b.exitBtn.activate()}}}),this.errorModal=new p({owner:this,handle:document.getElementById("error-modal"),visible:!1,model:{data:{title:"Ошибка",text:"Что-то не так, пожалуйста повторите попытку позже."},view:{handle:document.getElementById("error-modal"),template:!0}},active:!1,exitBtnHandle:".close",eventHandler:function(a){return(a.code===A.OK||a.code===A.EXIT)&&this.hide(),!0}}),this.sortRatingModal=new q({owner:this,handle:document.getElementById("sort-rating-modal"),list:[{title:"КиноПоиск",sort:"kp"},{title:"IMDb",sort:"imdb"},{title:"ivi.ru",sort:"ivi"}],events:{enter:function(){this.hide()}}}),this.sortBudgetModal=new q({owner:this,handle:document.getElementById("sort-budget-modal"),list:[{title:"по бюджету",sort:"budget"},{title:"по сборам",sort:"boxoffice"}],events:{enter:function(){this.hide()}}}),x.on("authorized",function(){var a=y.get("email"),b=y.get("password");(a!==this.get("email")||b!==this.get("password"))&&(y.set("email",this.get("email")),y.set("password",this.get("password")),y.set("uid",this.generateUID()),y.save())}),x.on("authError",function(){b.showError("Неверное имя пользователя или пароль")}),x.on("reqError",function(){b.showError("Ошибка связи. Пожалуйста повторите попытку позже")}),x.on("logout",function(){y.remove("email"),y.remove("password"),y.set("uid",this.generateUID()),y.set("videoQuality","hi"),y.save()}),y.once("load",function(){var a,b;this.get("uid")||this.set("uid",x.generateUID()),B.data.user?(B.data.user.session=B.data.session,x.setAll(B.data.user),y.set("session",B.data.session),x.authorized=!0,x.emit("authorized",B.data)):(a=this.get("email"))&&(b=this.get("password"))&&x.authorize(a,b)})}var e,f=a("lib/application"),g=a("pages/main"),h=a("pages/genre"),i=a("pages/search"),j=a("pages/profile"),k=a("pages/agreements"),l=a("pages/sorted"),m=a("components/header"),n=a("components/footer"),o=a("components/menu"),p=a("modals/modal"),q=a("modals/list"),r=a("components/button"),s=a("modals/authorization"),t=a("pages/details"),u=a("components/quickinfo"),v=a("pages/player"),w=a("lib/player"),x=a("models/user"),y=a("./config"),z=a("lib/tools"),A=a("lib/keys"),B=a("lib/partnership"),C=a("lib/request"),D=a("./dictionary");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.prototype.showError=function(a){this.errorModal.model.set("text",a),this.errorModal.show()},d.prototype.eventHandler=function(a){if(f.prototype.eventHandler.call(this,a)===!0)return!0;switch(a.code){case A.MENU:return this.showMenu(),!0;case A.EXIT:return this.exit(),!0;case A.POWER:return this.standBy(),!0}return!1},d.prototype.showMenu=function(){this.menu.show()},d.prototype.exit=function(){window.parent!==window?window.parent.postMessage("hide","*"):this.exitModal.show()},d.prototype.standBy=function(){var a=!gSTB.GetStandByStatus(),b=gSTB.StandByMode;3===b?(gSTB.IsPlaying()&&this.playerPage.exit(),gSTB.SetLedIndicatorMode(2),gSTB.StandBy(!0),gSTB.SetLedIndicatorMode(1)):1===b&&(a?(gSTB.IsPlaying()?(e=gSTB.GetPosTime(),w.emit("pause")):e=0,gSTB.SetLedIndicatorMode(1),gSTB.StandBy(!0)):(gSTB.SetLedIndicatorMode(2),gSTB.StandBy(!1),e&&(w.emit("continue"),setTimeout(function(){gSTB.SetPosTime(e)},200))))},window.moveTo(0,0),window.resizeTo(screen.width,screen.height),window.onload=function(){var a,b,c,e=["AuraHD2","AuraHD7","AuraHD8","WR320"],f=["img/bg_black_50.png","img/bg_black_85.png","img/bg_red_50.png","img/bg_white_30.png","img/menu_bg.jpg","img/menu_bg2.jpg"],g=["loading_ani.gif","arrow_bottom.png","arrow_left.png","arrow_right.png","arrow_top.png","avatar_female.png","avatar_male.png","btn_arrow_close.png","btn_arrow_open.png","btn_back.png","btn_exit.png","btn_f1.png","btn_f2.png","btn_f3.png","btn_f4.png","btn_ffwd.png","btn_ffwd_focused.png","btn_focused.png","btn_frame.png","btn_info.png","btn_kb_del.png","btn_kb_del_focused.png","btn_kb_left.png","btn_kb_left_focused.png","btn_kb_right.png","btn_kb_right_focused.png","btn_kb_shift.png","btn_kb_shift_focused.png","btn_kb_space.png","btn_kb_space_focused.png","btn_menu_focused.png","btn_menu_normal.png","btn_normal.png","btn_pause.png","btn_pause_focused.png","btn_play.png","btn_play_focused.png","btn_popup.png","btn_popup_focused.png","btn_rew.png","btn_rew_focused.png","button_focused.png","button_normal.png","header_bg.png","header_logo.png","modal_bg.png","modal_close.png","modal_list.png","promo_preview.png","quickinfo_bg.png","row_active.png","thumb.png","thumb_focused.png","video-preview.png"];for(c=screen.height>=576?screen.height:576,a=0,b=g.length;b>a;a++)f.push("img/"+c+"/"+g[a]);for(a=0;a<e.length;a++)if(-1!==e[a].indexOf(gSTB.GetDeviceModelExt())){document.body.classList.add("new-buttons");break}z.imageLoader(f,function(){B.init(function(){C.sign.init(),D.init(function(){window.ivi=new d,document.body.classList.remove("invisible"),window.parent!==window&&window.parent.postMessage("show","*")})})}),gSTB.EnableServiceButton(!1),gSTB.EnableVKButton(!1),gSTB.EnableAppButton(!1),gSTB.EnableTvButton&&gSTB.EnableTvButton(!1),document.body.addEventListener("click",function(a){a.stopPropagation(),a.stopImmediatePropagation(),a.preventDefault()})}},{"./config":40,"./dictionary":41,"components/button":"+xiQfc","components/footer":"SHo47G","components/header":"zExk/C","components/menu":"iHD9HF","components/quickinfo":"uFvIi8","lib/application":"8NvQGu","lib/keys":"iIRFqq","lib/partnership":"+TvC+8","lib/player":"LZDS0b","lib/request":"oP21hV","lib/tools":"AjqgZI","modals/authorization":"UgnP4x","modals/list":"/X0zSk","modals/modal":"BjgSXc","models/user":"QAloAk","pages/agreements":"u2t6GX","pages/details":"PcF5dW","pages/genre":"VmX1kv","pages/main":"leTyfk","pages/player":"JjW+Ru","pages/profile":"B3R0cH","pages/search":"sZ0N3q","pages/sorted":"K/khU5"}],"lib/ajax.collection":[function(a,b,c){b.exports=a("fqWis0")},{}],fqWis0:[function(a,b,c){"use strict";function d(a){this.defaults={autoload:!1,params:{}},e.call(this,g.defaults(a,this.defaults)),this.autoload===!0&&this.fetch(),this.fetching=!1}var e=a("./collection"),f=a("./request"),g=a("./tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.fetch=function(a){var b=this;this.url&&(this.fetching=!0,this.emit("request"),this.request=f({url:this.url,data:a||this.getParameters(),method:"GET",success:function(a){a="function"==typeof b.parse?b.parse(a):a,b.models(a),b.fetching=!1,b.emit("fetch",a)}}))},d.prototype.merge=function(a){var b=this;this.url&&(this.fetching=!0,this.emit("request"),this.request=f({url:this.url,data:a||this.getParameters(),method:"GET",success:function(a){a="function"==typeof b.parse?b.parse(a):a;var c=0;if(Array.isArray(a))for(;c<a.length;c++)b.add(a[c]);b.emit("models",{models:b._data}),b.fetching=!1,b.emit("fetch",a)}}))},d.prototype.abort=function(){this.request&&this.request.abort()},d.prototype.setParameter=function(a,b){this.params[a]=b},d.prototype.setParameters=function(a){for(var b in a)a.hasOwnProperty(b)&&this.setParameter(b,a[b])},d.prototype.getParameter=function(a){return this.params[a]},d.prototype.getParameters=function(){return this.params},b.exports=d},{"./collection":"Ou0jNv","./request":"oP21hV","./tools":"AjqgZI"}],"lib/ajax.model":[function(a,b,c){b.exports=a("/TtyQ3")},{}],"/TtyQ3":[function(a,b,c){"use strict";function d(a){e.call(this,a)}var e=a("./model"),f=a("./request");a("./tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.save=function(){var a=this;this.url&&f({url:this.url,method:a._data[a.idName]?"put":"post",data:a.pack(),onload:function(b){b=a.unpack(a.parse(b)),a.attributes(b),a.emit("save",!0)},onerror:this.saveFailure,ontimeout:this.saveFailure})},b.exports={}},{"./model":"blv/2e","./request":"oP21hV","./tools":"AjqgZI"}],"lib/application":[function(a,b,c){b.exports=a("8NvQGu")},{}],"8NvQGu":[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={name:"Application",pages:{},pageManager:{pages:a.pages},components:{},models:{},collections:{},_events:new Object(null),activeChild:null,activeModal:null,activeModals:[]},m.extend(this,m.defaults(a,this.defaults)),this.addHash("components",j,this.components),this.addHash("models",i,this.models),this.addHash("collections",f,this.collections),this.events&&this.bindAll(this.events),this.eventExclusions=[l.MENU,l.LEFT,l.RIGHT,l.UP,l.DOWN,l.OK,l.PAGE_DOWN,l.PAGE_UP,l.BACK,l.CHANNEL_NEXT,l.CHANNEL_PREV],this.setPageManager(this.pageManager),k.init(["keydown","input"]),k.on("keydown",function(a){m.prepareEvent(a),-1!==b.eventExclusions.indexOf(a.code)&&a.preventDefault(),a.code&&b.emit("keydown",a)}),this.on("keydown",function(a){b.eventHandler(a)})}var e=a("./page.manager"),f=a("./collection"),g=a("./emitter"),h=a("./thash"),i=a("./model"),j=a("./cbase"),k=a("./listener"),l=a("./keys"),m=a("./tools");d.prototype.addHash=function(a,b,c){this[a]=new h({type:b,data:c})},d.prototype.setPageManager=function(a){a instanceof e||(a=new e(a)),this.pageManager=a},d.prototype.eventHandler=function(a){return this.activeModal&&"function"==typeof this.activeModal.eventHandler&&this.activeModal.eventHandler(a)===!0?!0:this.activeChild&&"function"==typeof this.activeChild.eventHandler&&this.activeChild.eventHandler(a)===!0?!0:this.pageManager.eventHandler(a)},g.inject(d),b.exports=d},{"./cbase":"tTNRm4","./collection":"Ou0jNv","./emitter":"P7cBNP","./keys":"iIRFqq","./listener":"0gs5AI","./model":"blv/2e","./page.manager":"O89K3x","./thash":"mtNT1s","./tools":"AjqgZI"}],"lib/blowfish":[function(a,b,c){b.exports=a("5JT8b3")},{}],"5JT8b3":[function(a,b,c){"use strict";function d(){}d.prototype.BLOCKSIZE=8,d.prototype.SBOXES=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]],d.prototype.PARRAY=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],d.prototype.NN=16,d.prototype._clean=function(a){if(0>a){var b=2147483647&a;a=b+2147483648}return a},d.prototype._F=function(a){var b,c,d,e,f;return e=255&a,a>>>=8,d=255&a,a>>>=8,c=255&a,a>>>=8,b=255&a,f=this.sboxes[0][b]+this.sboxes[1][c],f^=this.sboxes[2][d],f+=this.sboxes[3][e]},d.prototype._encrypt_block=function(a){var b,c,d=a[0],e=a[1];for(b=0;b<this.NN;++b)d^=this.parray[b],e=this._F(d)^e,c=d,d=e,e=c;d^=this.parray[this.NN+0],e^=this.parray[this.NN+1],a[0]=this._clean(e),a[1]=this._clean(d)},d.prototype.encrypt_block=function(a){var b,c,d=[0,0],e=this.BLOCKSIZE/2;for(b=0;b<this.BLOCKSIZE/2;++b)d[0]=d[0]<<8|255&a[b+0],d[1]=d[1]<<8|255&a[b+e];for(this._encrypt_block(d),c=[],b=0;b<this.BLOCKSIZE/2;++b)c[b+0]=255&d[0],c[b+e]=255&d[1],d[0]=d[0]>>>8,d[1]=d[1]>>>8;return c},d.prototype._decrypt_block=function(a){var b,c,d=a[0],e=a[1];for(b=this.NN+1;b>1;--b)d^=this.parray[b],e=this._F(d)^e,c=d,d=e,e=c;d^=this.parray[1],e^=this.parray[0],a[0]=this._clean(e),a[1]=this._clean(d)},d.prototype.init=function(a){var b,c,d,e=0;for(this.parray=[],b=0;b<this.NN+2;++b){c=0;var f;for(f=0;4>f;++f)c=c<<8|255&a[e],++e>=a.length&&(e=0);this.parray[b]=this.PARRAY[b]^c}for(this.sboxes=[],b=0;4>b;++b)for(this.sboxes[b]=[],e=0;256>e;++e)this.sboxes[b][e]=this.SBOXES[b][e];for(d=[0,0],b=0;b<this.NN+2;b+=2)this._encrypt_block(d),this.parray[b+0]=d[0],this.parray[b+1]=d[1];for(b=0;4>b;++b)for(e=0;256>e;e+=2)this._encrypt_block(d),this.sboxes[b][e+0]=d[0],this.sboxes[b][e+1]=d[1]},b.exports=d},{}],tTNRm4:[function(a,b,c){"use strict";function d(a){if(this.defaults={name:"CBase",view:{handle:a.handle,owner:this,template:a.template||null},activated:!0,model:null,data:null,modal:!1,modelType:g,dataType:g,events:{},viewType:f,owner:null,handle:null,active:!1,visible:!0,saveDefaultView:!1,activeChild:null,activeModal:null,activeModals:[],components:new Object(null)},h.extend(this,h.defaults(a,this.defaults)),!this.handle||!this.handle.nodeName)throw"Wrong handle in "+this.name+" component.";this._events=Object(null),this.bindAll(this.events),this.model&&this.setModel(this.model),this.setView(this.view),this.visible===!0?this.show():this.hide(),this.setOwner(this.owner),this.active===!0&&this.activate(!0),this._startedActions=0,this.trigger("init")}var e=a("./emitter"),f=a("./view"),g=a("./model"),h=a("./tools");d.prototype.setView=function(a){var b=this;a instanceof f||(a.model=this.model,a=new this.viewType(a)),this.view=a,this.view.bindAll({show:function(){b.emit("show")},hide:function(){b.emit("hide")},click:function(){b.emit("click"),b.activate()}})},d.prototype.setModel=function(a){this.model instanceof g&&this.model.clear(),a instanceof g||!this.model||(a=new this.modelType(a)),this.model=a,this.view&&"function"==typeof this.view.setModel&&this.view.setModel(this.model),this.emit("setModel",a)},d.prototype.setData=function(a){this.data&&"function"==typeof this.data.clear&&this.data.clear(),a instanceof this.dataType||!this.data||(a=new this.dataType(a)),this.data=a,this.view&&"function"==typeof this.view.setData&&this.view.setData(this.model),this.emit("setData",a)},d.prototype.addComponent=function(a){a&&(a.owner=this,this.components[a.name]=a,a.previousComponent=this._lastAdded,this._lastAdded&&(this._lastAdded.nextComponent=a),this._lastAdded=a,a.isActive()&&a.activate(!0),this.emit("addComponent",a))},d.prototype.getComponent=function(a){return this.components[a]},d.prototype.activate=function(a){this.isActive()&&!a||this.activated===!1||!this.isVisible()||(this.active=!0,this.emit("activate"),this.handle.classList.add("active"),this.owner&&(this.modal===!0?(this.owner.activeModal=this,this.owner.activeModals.push(this)):(this.owner.activeChild&&this.owner.activeChild!==this&&this.owner.activeChild.deactivate(),this.owner.activeChild=this)))},d.prototype.deactivate=function(){if(this.isActive()&&this.activated!==!1&&(this.active=!1,this.emit("deactivate"),this.handle.classList.remove("active"),this.owner))if(this.modal){var a;this.owner.activeModals.pop(),a=this.owner.activeModals[this.owner.activeModals.length-1],this.owner.activeModal=a}else this.owner.activeChild=null},d.prototype.isActive=function(){return this.active===!0},d.prototype.setOwner=function(a){
a instanceof d&&(this.owner=a,this.emit("setOwner",a))},d.prototype.show=function(){this.view.show()},d.prototype.hide=function(){this.view.hide()},d.prototype.toggle=function(){this.view.toggle()},d.prototype.isVisible=function(){return this.view.isVisible()},d.prototype.clear=function(){h.extend(this,this.defaults)},d.prototype.startAction=function(a){0===this._startedActions++&&this.emit("startChanges"),this.emit("startAction",this._startedActions)},d.prototype.endAction=function(a){0===--this._startedActions&&this.emit("allReady"),this.emit("endAction",this._startedActions)},d.prototype.eventHandler=function(){return!1},e.inject(d),b.exports=d},{"./emitter":"P7cBNP","./model":"blv/2e","./tools":"AjqgZI","./view":"kWfdrx"}],"lib/cbase":[function(a,b,c){b.exports=a("tTNRm4")},{}],"lib/collection":[function(a,b,c){b.exports=a("Ou0jNv")},{}],Ou0jNv:[function(a,b,c){"use strict";function d(a){this._data=[],this._ids={},this.defaults={modelType:e,viewType:g,url:null,data:null,prepare:null,idName:"id"},h.extend(this,h.defaults(a||{},this.defaults)),this._events=new Object(null),this.events&&this.onAll(this.events),this.view&&this.setView(this.view),this.data&&this.models(this.data)}var e=a("./model"),f=a("./emitter"),g=a("./collection.view"),h=a("./tools");d.prototype.clear=function(){for(;this._data[0];)this.remove(this._data[0]);this._data=[],this._ids={},this.emit("clear")},d.prototype.models=function(a){var b=0;if(Array.isArray(a))for(this.clear();b<a.length;b++)this.add(a[b]);return this.emit("models",{models:this._data}),this._data},d.prototype.add=function(a){return a instanceof e||null===this.modelType||(a=new this.modelType({data:a})),this._ids[a.get(this.idName)]=a,this._data.push(a),this.emit("add",{model:a,index:this._data.length-1}),this.emit("changed",{event:"add",model:a,index:this._data.length}),a},d.prototype.addAll=function(a){var b=0;if(Array.isArray(a))for(;b<a.length;b++)this.add(a[b]);return this._data},d.prototype.insert=function(a,b){return a instanceof e||(a=new this.modelType({data:a})),this._ids[a.get(a.idName)]=a,this._data.splice(b,0,a),this.emit("add",{model:a,index:b}),this.emit("changed",{event:"add",model:a,index:b}),a},d.prototype.remove=function(a){var b=this.indexOf(a);return b>-1?("function"==typeof a.removeALlListeners&&a.removeAllListeners(),this.splice(b,1),delete this._ids[a.get("id")],this.emit("remove",{index:b,model:a}),this.emit("changed",{event:"remove",index:b,model:a}),a):null},d.prototype.removeAt=function(a){var b=this._data[a];return void 0!==b?(b.removeAllListeners(),this._data.splice(a,1),delete this._ids[b.get("id")],this.emit("remove",{index:a,model:b}),this.emit("changed",{event:"remove",index:a,model:b}),b):null},d.prototype.at=function(a){return this._data[a]},d.prototype.get=function(a){return this._ids[a]},d.prototype.getData=function(){return this._data},d.prototype.getArray=function(){var a,b=[];for(a=0;a<this._data.length;a++)b.push(this._data[a].getAll());return b},["filter","forEach","every","map","some","indexOf","slice","splice"].forEach(function(a){d.prototype[a]=function(){return Array.prototype[a].apply(this._data,arguments)}}),d.prototype.sort=function(a){this._data.sort(a),this.emit("sort")},d.prototype.setView=function(a){a instanceof this.viewType||(a.collection=this,a=new this.viewType(a)),this.view=a},d.prototype.first=function(a){if("function"==typeof a){for(var b=0;b<this._data.length;b++)if(a(this._data[b]))return this._data[b];return null}return this._data[0]},d.prototype.last=function(a){if("function"==typeof a){for(var b=this._data.length-1;b>=0;b--)if(a(this._data[b]))return this._data[b];return null}return this._data[this._data.length-1]},Object.defineProperty(d.prototype,"length",{get:function(){return this._data.length}}),f.inject(d),b.exports=d},{"./collection.view":"eoasPR","./emitter":"P7cBNP","./model":"blv/2e","./tools":"AjqgZI"}],"lib/collection.view":[function(a,b,c){b.exports=a("eoasPR")},{}],eoasPR:[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={collection:null,template:!0,watch:!1},e.call(this,g.defaults(a,this.defaults)),this.collection&&this.setCollection(this.collection),this.autoRender===!0&&null!==this.template&&this.update(),this.collection.on("add",function(a){var c=b.template.compile();a.model.setView({handle:c.element,compiled:c,template:b.template,watch:b.watch})}),this.watch===!0&&(this.watcher=new f(this.collection),this.watcher.on("watch",function(a){b.update(a)}),this.watcher.watch())}var e=a("./tview"),f=a("./watcher"),g=a("./tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setCollection=function(a,b){this.collection=a,this.watcher&&this.watcher.setData(a).watch(),b!==!1&&this.refresh()},d.prototype.update=function(a){var b;if(a.model&&a.model.view)switch(a.event){case"add":b=this.collection.at(a.index+1),b?a.model.view.insertBefore(b.view):this.appendChild(a.model.view);break;case"remove":a.model.view&&a.model.view.remove()}},d.prototype.refresh=function(){var a,b=this;this.collection.forEach(function(c){a=b.template.compile(),c.setView({handle:a.element,compiled:a,model:c,template:b.template,watch:b.watch}),b.appendChild(c.view)})},b.exports=d},{"./tools":"AjqgZI","./tview":"r32W0Q","./watcher":"/tW+0Y"}],"lib/cpage":[function(a,b,c){b.exports=a("B6eAZ7")},{}],B6eAZ7:[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={name:"CPage",active:!1,visible:!1,manager:null,dynamic:!1,header:null,footer:null,arrows:null},e.call(this,h.defaults(a,this.defaults)),this.scroller=new f({container:this.handle}),this.header&&this.setHeader(this.header),this.footer&&this.setFooter(this.footer),this.active===!0&&this.activate(),this.arrows&&this.setArrows(this.arrows),this.on("addComponent",function(a){a.on("activate",function(){b.scroller.show(a.handle)})})}var e=a("./cpanel"),f=a("./scroller"),g=a("lib/keys"),h=a("./tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.show=function(a,b){this.manager?(this.manager.show(this,a,b),this.emit("show")):e.prototype.show.call(this)},d.prototype.hide=function(){this.manager?(this.manager.hide(this),this.deactivate(),this.emit("hide")):e.prototype.hide.call(this)},d.prototype.setHeader=function(a){a instanceof e||this.on("activate",function(){null!==this.header&&this.header.deactivate()}),this.header=a},d.prototype.setFooter=function(a){a instanceof e||this.on("activate",function(){null!==this.footer&&this.footer.deactivate()}),this.footer=a},d.prototype.setArrows=function(a){var b=this;"string"==typeof a.previous&&(a.previous=this.handle.querySelector(a.previous)),"string"==typeof a.next&&(a.next=this.handle.querySelector(a.next)),a.previous.addEventListener("click",function(){b.movePrevious()}),a.next.addEventListener("click",function(){b.moveNext()})},d.prototype.eventHandler=function(a){if(this.activeModal&&"function"==typeof this.activeModal.eventHandler&&this.activeModal.eventHandler(a)===!0)return!0;switch(a.code){case g.EXIT:return void 0!==this.manager.back()}return e.prototype.eventHandler.call(this,a)},b.exports=d},{"./cpanel":"ySbxUr","./scroller":"8+NRr9","./tools":"AjqgZI","lib/keys":"iIRFqq"}],"lib/cpanel":[function(a,b,c){b.exports=a("ySbxUr")},{}],ySbxUr:[function(a,b,c){"use strict";function d(a){this.defaults={name:"CPanel"},e.call(this,f.defaults(a,this.defaults)),this.components&&this.addComponents(this.components)}var e=a("lib/cbase"),f=a("lib/tools"),g=a("lib/keys");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.addComponents=function(a){for(var b=0;b<a.length;b++)this.addComponent(a[b])},d.prototype.findNextComponent=function(a){return a&&a.nextComponent?a.nextComponent.activated!==!1?a.nextComponent:this.findNextComponent(a.nextComponent):null},d.prototype.findPreviousComponent=function(a){return a&&a.previousComponent?a.previousComponent.activated!==!1?a.previousComponent:this.findPreviousComponent(a.previousComponent):null},d.prototype.moveNext=function(){var a=this.findPreviousComponent(this.activeChild);return null===a?!1:(a.activate(),!0)},d.prototype.movePrevious=function(){var a=this.findNextComponent(this.activeChild);return null===a?!1:(a.activate(),!0)},d.prototype.eventHandler=function(a){if(this.activeChild&&"function"==typeof this.activeChild.eventHandler&&this.activeChild.eventHandler(a)===!0)return!0;var b=g.UP,c=g.DOWN;switch("horizontal"===this.navigation&&(b=g.LEFT,c=g.RIGHT),a.code){case b:return this.moveNext();case c:return this.movePrevious()}return!1},b.exports=d},{"lib/cbase":"tTNRm4","lib/keys":"iIRFqq","lib/tools":"AjqgZI"}],CBUzS7:[function(a,b,c){b.exports=function(){"use strict";var a={};return a.clear=function(a){return a instanceof Node&&(a.innerHTML=""),a},a.remove=function(a){a instanceof Node&&a.parentNode instanceof Node&&a.parentNode.removeChild(a)},a.tag=function(a,b){var c,d="object"==typeof b&&null!==b?Object.keys(b):[],e=null;if(a){for(e=document.createElement(a),c=0;c<d.length;c++)e[d[c]]=b[d[c]];for(c=2;c<arguments.length;c++)if(arguments[c]instanceof HTMLCollection)for(;arguments[c][0];)e.appendChild(arguments[c][0]);else e.appendChild(arguments[c]instanceof Node?arguments[c]:document.createTextNode(arguments[c]))}return e},a.fragment=function(){var a,b=document.createDocumentFragment();for(a=0;a<arguments.length;a++)if(arguments[a])if(arguments[a]instanceof Node)b.appendChild(arguments[a]);else if(arguments[a]instanceof HTMLCollection)for(;arguments[a].length;)b.appendChild(arguments[a][0]);else b.appendChild(document.createTextNode(arguments[a]));return b},a.add=function(a){var b;if(a instanceof Node)for(b=1;b<arguments.length;b++)arguments[b]&&a.appendChild(arguments[b]instanceof Node?arguments[b]:document.createTextNode(arguments[b]));return a},a.addChild=function(b,c){var d;if(b&&c)if(c.nodeType)d=b.appendChild(c);else if(Array.isArray(c)){d=[];for(var e=0;e<c.length;e++)d.push(a.addChild(b,c[e]))}else d=b.appendChild(document.createTextNode(c));return d},a.value=function(a,b){switch(a.tagName.toLowerCase()){case"img":a.src=b;break;case"input":a.value=b;break;default:a.innerHTML=b}},a.show=function(a){a.classList&&a.classList.remove("hidden")},a.hide=function(a){a.classList&&a.classList.add("hidden")},a.toggle=function(a){a.classList&&a.classList.toggle("hidden")},a.isVisible=function(a){return a.classList?!a.classList.contains("hidden"):void 0},a}()},{}],"lib/dom":[function(a,b,c){b.exports=a("CBUzS7")},{}],P7cBNP:[function(a,b,c){"use strict";var d=a("./tools"),e={addListener:function(a,b){return this._events[a]=this._events[a]||[],this._events[a].push(b),this},addListeners:function(a){var b,c;for(b in a)if(a.hasOwnProperty(b))if(Array.isArray(a[b]))for(c=0;c<a[b].length;c++)this.addListener(b,a[b][c]);else this.addListener(b,a[b]);return this},removeListener:function(a,b){return Array.isArray(this._events[a])&&(this._events[a]=this._events[a].filter(function(a){return a!==b}),0===this._events[a].length&&delete this._events[a]),this},removeAllListeners:function(a){return 0===arguments.length?this._events=Object.create(null):1===arguments.length&&delete this._events[a],this},emit:function(a,b){var c,d;if(Array.isArray(this._events[a]))for(d=this._events[a].slice(),c=0;c<d.length;c++)d[c].call(this,b);return this},once:function(a,b){var c=this;return this.addListener(a,function d(e){c.removeListener(a,d),b.call(c,e)}),this},inject:function(a){"function"==typeof a?(a.prototype._events=Object.create(null),d.extend(a.prototype,this)):"object"==typeof a&&(a._events=Object.create(null),d.extend(a,this))}};e.on=e.bind=e.addListener,e.trigger=e.emit,e.unbind=e.off=e.removeListener,e.unbindAll=e.offAll=e.removeAllListeners,e.onAll=e.bindAll=e.addListeners,b.exports=e},{"./tools":"AjqgZI"}],"lib/emitter":[function(a,b,c){b.exports=a("P7cBNP")},{}],"lib/jsondb":[function(a,b,c){b.exports=a("NhVVdj")},{}],NhVVdj:[function(a,b,c){"use strict";function d(a){this.data=a||{}}function e(a){this.data=a||{}}d.prototype.table=function(a){return a?("object"!=typeof this.data[a]&&(this.data[a]={}),new e(this.data[a])):!1},e.prototype.init=function(){if(arguments.length>0){this.data.rows={},this.data.idName=Array.prototype.shift.call(arguments),this.data.rowIdx=0,this.data.fldIds=[],this.data.fldIdx={};for(var a=0;a<arguments.length;a++)this.data.fldIds[a]=arguments[a],this.data.fldIdx[arguments[a]]=a;return!0}return!1},e.prototype.genId=function(){return(++this.data.rowIdx).toString()},e.prototype.add=function(a){var b,c=[];if(a&&void 0===this.data.rows[a]){for(b=0;b<this.data.fldIds.length;b++)c[b]=void 0!==arguments[b+1]?arguments[b+1]:null;return this.data.rows[a]=c,!0}return!1},e.prototype.get=function(a,b){var c,d=this.data.rows[a],e={};if(void 0!==d){if(void 0===b){for(e[this.data.idName]=a.toString(),c=0;c<d.length;c++)e[this.data.fldIds[c]]=d[c];return e}if(b in this.data.fldIdx)return d[this.data.fldIdx[b]]}return!1},e.prototype.set=function(a,b){var c,d,e=[];if(a&&b&&"object"==typeof b){if(void 0===this.data.rows[a]){for(c=0;c<this.data.fldIds.length;c++)e[c]=null;this.data.rows[a]=e}else e=this.data.rows[a];for(d in b)d in this.data.fldIdx&&(e[this.data.fldIdx[d]]=b[d]);return!0}return!1},e.prototype.unset=function(a){return delete this.data.rows[a]},e.prototype.clear=function(){this.data.rows={},this.data.rowIdx=0},e.prototype.find=function(a,b){var c,d,e,f,g,h=this.data.rows,i=[];if(a&&"object"==typeof a)for(d in h)if(h.hasOwnProperty(d)){f=!0;for(e in a)a.hasOwnProperty(e)&&(f=f&&h[d][this.data.fldIdx[e]]===a[e]);if(f){for(c={},c[this.data.idName]=d,g=0;g<h[d].length;g++)c[this.data.fldIds[g]]=h[d][g];if(i.push(c),void 0!==b&&b===i.length)return i}}return i},b.exports=d},{}],iIRFqq:[function(a,b,c){"use strict";b.exports={BACK:8,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,NUM9:57,NUM0:48,DELETE:46,CHANNEL_PREV:1009,CHANNEL_NEXT:9,OK:13,EXIT:27,UP:38,DOWN:40,LEFT:37,RIGHT:39,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,VOLUME_UP:107,VOLUME_DOWN:109,F1:112,F2:113,F3:114,F4:115,REFRESH:116,FRAME:117,PHONE:119,SET:120,TV:121,MENU:122,WEB:123,MIC:2032,REWIND:2066,FORWARD:2070,APP:2076,USB_MOUNTED:2080,USB_UNMOUNTED:2081,PLAY_PAUSE:2082,STOP:2083,POWER:2085,RECORD:2087,INFO:2089,MUTE:2192,CLOCK:2032,AUDIO:2071}},{}],"lib/keys":[function(a,b,c){b.exports=a("iIRFqq")},{}],"0gs5AI":[function(a,b,c){"use strict";var d=a("./emitter"),e={init:function(a){if(this._events=new Object(null),a)for(var b=0;b<a.length;b++)this.listen(a[b])},listen:function(a){var b=this;return document.body.addEventListener(a,function(c){b.emit(a,c)}),this}};d.inject(e),b.exports=e},{"./emitter":"P7cBNP"}],"lib/listener":[function(a,b,c){b.exports=a("0gs5AI")},{}],ieUPCh:[function(a,b,c){"use strict";function d(a){this.defaults={name:"LocalModel",autoLoad:!1,savedFields:[]},e.call(this,f.defaults(a,this.defaults)),this.autoLoad&&this.load()}var e=a("lib/model"),f=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.save=function(){var a,b,c=this.getAll(),d=Object.keys(c);for(a=d.length;a;)b=d[--a],-1===this.savedFields.indexOf(b)&&delete c[b];gSTB.SaveUserData(this.name,JSON.stringify(c))},d.prototype.load=function(){var a={};try{a=JSON.parse(gSTB.LoadUserData(this.name)||"{}")}catch(b){}this.setAll(a),this.emit("load")},b.exports=d},{"lib/model":"blv/2e","lib/tools":"AjqgZI"}],"lib/local.model":[function(a,b,c){b.exports=a("ieUPCh")},{}],"lib/lodash":[function(a,b,c){b.exports=a("aQJBiS")},{}],aQJBiS:[function(a,b,c){var d="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};b.exports=function(a,e){"use strict";function f(a,b,c){b||(b=0),"undefined"==typeof c&&(c=a?a.length:0);for(var d=-1,e=c-b||0,f=new Array(0>e?0:e);++d<e;)f[d]=a[b+d];return f}function g(){}function h(a){function b(){if(d){var a=d.slice();aa.apply(a,arguments)}if(this instanceof b){var f=i(c.prototype),g=c.apply(f,a||arguments);return r(g)?g:f}return c.apply(e,a||arguments)}var c=a[0],d=a[2],e=a[4];return ga(b,a),b}function i(a,b){return r(a)?R(a):{}}function j(a,b,c){if("function"!=typeof a)return u;if("undefined"==typeof b||!("prototype"in a))return a;var d=a.__bindData__;if("undefined"==typeof d&&(ea.funcNames&&(d=!a.name),d=d||!ea.funcDecomp,!d)){var e=$.call(a);ea.funcNames||(d=!x.test(e)),d||(d=y.test(e),ga(a,d))}if(d===!1||d!==!0&&1&d[1])return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return t(a,b)}function l(a){function b(){var a=k?h:this;if(e){var q=e.slice();aa.apply(q,arguments)}if((g||n)&&(q||(q=f(arguments)),g&&aa.apply(q,g),n&&q.length<j))return d|=16,l([c,o?d:-4&d,q,null,h,j]);if(q||(q=arguments),m&&(c=a[p]),this instanceof b){a=i(c.prototype);var s=c.apply(a,q);return r(s)?s:a}return c.apply(a,q)}var c=a[0],d=a[1],e=a[2],g=a[3],h=a[4],j=a[5],k=1&d,m=2&d,n=4&d,o=8&d,p=c;return ga(b,a),b}function m(a,b,c,d,e,f){var g=1&b,i=2&b,j=4&b,k=16&b,n=32&b;if(!i&&!q(a))throw new TypeError;k&&!c.length&&(b&=-17,k=c=!1),n&&!d.length&&(b&=-33,n=d=!1);var o=a&&a.__bindData__;if(o&&o!==!0)return o=o.slice(),!g||1&o[1]||(o[4]=e),!g&&1&o[1]&&(b|=8),!j||4&o[1]||(o[5]=f),k&&aa.apply(o[2]||(o[2]=[]),c),n&&aa.apply(o[3]||(o[3]=[]),d),o[1]|=b,m.apply(null,o);var p=1==b||17===b?h:l;return p([a,b,c,d,e,f])}function n(){L.shadowedProps=z,L.array=L.bottom=L.loop=L.top="",L.init="iterable",L.useHas=!0;for(var a,b=0;a=arguments[b];b++)for(var c in a)L[c]=a[c];var d=L.args;L.firstArg=/^[^,]+/.exec(d)[0];var e=Function("baseCreateCallback, errorClass, errorProto, hasOwnProperty, indicatorObject, isArguments, isArray, isString, keys, objectProto, objectTypes, nonEnumProps, stringClass, stringProto, toString","return function("+d+") {\n"+fa(L)+"\n}");return e(j,E,V,_,w,o,ha,s,L.keys,W,M,da,J,X,Y)}function o(a){return a&&"object"==typeof a&&"number"==typeof a.length&&Y.call(a)==A||!1}function p(a,b){var c=i(a);return b?la(c,b):c}function q(a){return"function"==typeof a}function r(a){return!(!a||!M[typeof a])}function s(a){return"string"==typeof a||a&&"object"==typeof a&&Y.call(a)==J||!1}function t(a,b){return arguments.length>2?m(a,17,f(arguments,2),null,b):m(a,1,null,null,b)}function u(a){return a}function v(){}var w={},x=/^\s*function[ \n\r\t]+\w/,y=/\bthis\b/,z=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],A="[object Arguments]",B="[object Array]",C="[object Boolean]",D="[object Date]",E="[object Error]",F="[object Function]",G="[object Number]",H="[object Object]",I="[object RegExp]",J="[object String]",K={configurable:!1,enumerable:!1,value:null,writable:!1},L={args:"",array:null,bottom:"",firstArg:"",init:"",keys:null,loop:"",shadowedProps:null,support:null,top:"",useHas:!1},M={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},N=M[typeof a]&&a||this,O=M[typeof c]&&c&&!c.nodeType&&c,P=M[typeof b]&&b&&!b.nodeType&&b,Q=M[typeof d]&&d;!Q||Q.global!==Q&&Q.window!==Q||(N=Q);var R,S,T,U=[],V=Error.prototype,W=Object.prototype,X=String.prototype,Y=W.toString,Z=RegExp("^"+String(Y).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),$=Function.prototype.toString,_=W.hasOwnProperty,aa=U.push,ba=W.propertyIsEnumerable,ca=function(){try{var a={},b=Z.test(b=Object.defineProperty)&&b,c=b(a,a,a)&&b}catch(d){}return c}();R=Z.test(R=Object.create)&&R,S=Z.test(S=Array.isArray)&&S,T=Z.test(T=Object.keys)&&T;var da={};da[B]=da[D]=da[G]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},da[C]=da[J]={constructor:!0,toString:!0,valueOf:!0},da[E]=da[F]=da[I]={constructor:!0,toString:!0},da[H]={constructor:!0},function(){for(var a=z.length;a--;){var b=z[a];for(var c in da)_.call(da,c)&&!_.call(da[c],b)&&(da[c][b]=!1)}}();var ea=g.support={};!function(){var a=function(){this.x=1},b={0:1,length:1},c=[];a.prototype={valueOf:1,y:1};for(var d in new a)c.push(d);for(d in arguments);ea.argsClass=Y.call(arguments)==A,ea.argsObject=arguments.constructor==Object&&!(arguments instanceof Array),ea.enumErrorProps=ba.call(V,"message")||ba.call(V,"name"),ea.enumPrototypes=ba.call(a,"prototype"),ea.funcDecomp=!Z.test(N.WinRTError)&&y.test(function(){return this}),ea.funcNames="string"==typeof Function.name,ea.nonEnumArgs=0!=d,ea.nonEnumShadows=!/valueOf/.test(c),ea.spliceObjects=(U.splice.call(b,0,1),!b[0]),ea.unindexedChars="x"[0]+Object("x")[0]!="xx"}(1);var fa=function(a){var b="'use strict';\nvar index, iterable = "+a.firstArg+", result = "+a.init+";\nif (!iterable) return result;\n"+a.top+";";a.array?(b+="\nvar length = iterable.length; index = -1;\nif ("+a.array+") {  ",ea.unindexedChars&&(b+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),b+="\n  while (++index < length) {\n    "+a.loop+";\n  }\n}\nelse {  "):ea.nonEnumArgs&&(b+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+a.loop+";\n    }\n  } else {  "),ea.enumPrototypes&&(b+="\n  var skipProto = typeof iterable == 'function';\n  "),ea.enumErrorProps&&(b+="\n  var skipErrorProps = iterable === errorProto || iterable instanceof Error;\n  ");var c=[];if(ea.enumPrototypes&&c.push('!(skipProto && index == "prototype")'),ea.enumErrorProps&&c.push('!(skipErrorProps && (index == "message" || index == "name"))'),a.useHas&&a.keys)b+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] && keys(iterable),\n      length = ownProps ? ownProps.length : 0;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n",c.length&&(b+="    if ("+c.join(" && ")+") {\n  "),b+=a.loop+";    ",c.length&&(b+="\n    }"),b+="\n  }  ";else if(b+="\n  for (index in iterable) {\n",a.useHas&&c.push("hasOwnProperty.call(iterable, index)"),c.length&&(b+="    if ("+c.join(" && ")+") {\n  "),b+=a.loop+";    ",c.length&&(b+="\n    }"),b+="\n  }    ",ea.nonEnumShadows){for(b+="\n\n  if (iterable !== objectProto) {\n    var ctor = iterable.constructor,\n        isProto = iterable === (ctor && ctor.prototype),\n        className = iterable === stringProto ? stringClass : iterable === errorProto ? errorClass : toString.call(iterable),\n        nonEnum = nonEnumProps[className];\n      ",k=0;k<7;k++)b+="\n    index = '"+a.shadowedProps[k]+"';\n    if ((!(isProto && nonEnum[index]) && hasOwnProperty.call(iterable, index))",a.useHas||(b+=" || (!nonEnum[index] && iterable[index] !== objectProto[index])"),b+=") {\n      "+a.loop+";\n    }      ";b+="\n  }    "}return(a.array||ea.nonEnumArgs)&&(b+="\n}"),b+=a.bottom+";\nreturn result"};R||(i=function(){function a(){}return function(b){if(r(b)){a.prototype=b;var c=new a;a.prototype=null}return c||N.Object()}}());var ga=ca?function(a,b){K.value=b,ca(a,"__bindData__",K)}:v;ea.argsClass||(o=function(a){return a&&"object"==typeof a&&"number"==typeof a.length&&_.call(a,"callee")&&!ba.call(a,"callee")||!1});var ha=S||function(a){return a&&"object"==typeof a&&"number"==typeof a.length&&Y.call(a)==B||!1},ia=n({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)"}),ja=T?function(a){return r(a)?ea.enumPrototypes&&"function"==typeof a||ea.nonEnumArgs&&a.length&&o(a)?ia(a):T(a):[]}:ia,ka={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",keys:ja,loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},la=n(ka,{top:ka.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = baseCreateCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"});return q(/x/)&&(q=function(a){return"function"==typeof a&&Y.call(a)==F}),g.assign=la,g.bind=t,g.create=p,g.keys=ja,g.extend=la,g.identity=u,g.isArguments=o,g.isArray=ha,g.isFunction=q,g.isObject=r,g.isString=s,g.noop=v,g.VERSION="2.3.0",O&&P&&(O._=g),O._}(this)},{}],"blv/2e":[function(a,b,c){"use strict";function d(a){this.defaults={data:null,view:null,idName:"id",viewType:f},this._data=Object.create(null),this._events=new Object(null),g.extend(this,g.defaults(a,this.defaults)),this.events&&this.onAll(this.events),this.data&&this.setAll(this.data),this.view&&this.setView(this.view)}var e=a("./emitter"),f=a("./model.view"),g=a("./tools");d.prototype.setView=function(a){a instanceof this.viewType||(a.model=this,a=new this.viewType(a)),this.view=a},d.prototype.clear=function(){var a,b=this.keys();for(a=0;a<b.length;a++)this.remove(b[a]);this._data=Object.create(null),this.emit("clear")},d.prototype.reset=function(){this.clear(),this.setAll(this.data),this.emit("reset")},d.prototype.getAll=function(){var a,b={},c=this.keys();for(a=0;a<c.length;a++)b[c[a]]=this.get(c[a]);return b},d.prototype.get=function(a){return this._data[a]},d.prototype.getDeep=function(a){var b,c,e=a.indexOf(".");return-1!==e&&(b=a.substr(0,e),c=this._data[b],c instanceof d)?c.getDeep(a.substr(e+1)):this.get(a)},d.prototype.set=function(a,b){var c=this.get(a),d={key:a,value:b,previous:c,event:"set"};b!==c&&(this.emit(a+":set",d),this.emit("changed",d),this._data[a]=d.value)},d.prototype.setAll=function(a){for(var b=0,c=a&&"object"==typeof a?Object.keys(a):[];b<c.length;b++)this.set(c[b],a[c[b]]);this.emit("setAll")},d.prototype.keys=function(){return Object.keys(this._data)||[]},d.prototype.has=function(a){return this._data.hasOwnProperty(a)},d.prototype.remove=function(a){var b=this.get(a);delete this._data[a],this.emit("remove:"+a,{previous:b}),this.emit("changed",{key:a,event:"remove",previous:b})},d.prototype.pack=function(){return this._data},d.prototype.unpack=function(a){return a},d.prototype.save=function(){},d.prototype.parse=function(a){var b={};try{b=JSON.parse(a).data}catch(c){}return b},e.inject(d),b.exports=d},{"./emitter":"P7cBNP","./model.view":"ESYGw6","./tools":"AjqgZI"}],"lib/model":[function(a,b,c){b.exports=a("blv/2e")},{}],ESYGw6:[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={autoRender:!0,model:null,template:null,watcher:null,watch:!1},a.model&&this.setModel(a.model,!1),e.call(this,g.defaults(a,this.defaults)),this.watch===!0&&(this.watcher=new f(this.model),this.watcher.on("watch",function(a){b.updateField(a)}),this.watcher.watch())}var e=a("./tview"),f=a("./watcher"),g=a("./tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setModel=function(a,b){this.model=a,this.watcher&&this.watcher.setData(this.model).watch(),b!==!1&&this.update()},b.exports=d},{"./tools":"AjqgZI","./tview":"r32W0Q","./watcher":"/tW+0Y"}],"lib/model.view":[function(a,b,c){b.exports=a("ESYGw6")},{}],O89K3x:[function(a,b,c){"use strict";function d(a){this.defaults={history:[],pages:{},mainPage:null,_events:new Object(null)},g.extend(this,g.defaults(a,this.defaults)),this.events&&this.onAll(this.events),this.setPages(this.pages)}var e=a("./cpage"),f=a("./emitter"),g=a("./tools");d.prototype.setPages=function(a){for(var b=0;b<a.length;b++)this.addPage(a[b])},d.prototype.addPage=function(a){var b=this;return a instanceof e||(a=new e(a)),a.owner=a.manager=this,a.dynamic===!0&&(a.on("startChanges",function(){b.emit("startChanges")}),a.on("allReady",function(){b.emit("allReady")})),this.pages[a.name]=a,a},d.prototype.setMainPage=function(a){this.mainPage=this.addPage(a)},d.prototype.main=function(a){return a&&this.setMainPage(a),this.mainPage},d.prototype.page=function(a,b){return 2===arguments.length&&this.addPage(a,b),this.pages[a]},d.prototype.show=function(a,b,c){var d=this.current(),e=g.uniqueID();d&&d.hide(),c!==!1&&this.history.push({page:a,data:b,state:e}),"function"==typeof a.prepare&&(a.prepare(b),a._state=e),a.view.handle.classList.remove("invisible"),a.activate()},d.prototype.hide=function(a){a.view.handle.classList.add("invisible")},d.prototype.back=function(){var a=this.history.pop(),b=this.history[this.history.length-1]||{page:this.mainPage};return a&&(a.page.deactivate(),a.page.hide()),b.page&&(b.page.activate(),b.data&&b.state!==b.page._state&&b.page.prepare(b.data),b.page.view.handle.classList.remove("invisible"),b.page.emit("show")),a},d.prototype.current=function(){return this.history[this.history.length-1]?this.history[this.history.length-1].page:this.mainPage},d.prototype.eventHandler=function(a){var b=this.current();return b&&b.isActive()&&b.eventHandler&&b.eventHandler(a)===!0},f.inject(d),b.exports=d},{"./cpage":"B6eAZ7","./emitter":"P7cBNP","./tools":"AjqgZI"}],"lib/page.manager":[function(a,b,c){b.exports=a("O89K3x")},{}],"+TvC+8":[function(a,b,c){var d=a("./request"),e=a("../config"),f=a("../modals/modal"),g=a("./keys"),h=a("./tools"),i=a("./listener"),j={};j.data={},j.init=function(a){var b=h.getUrlParameters("partner");b?(j.data.partner=b,j.register(function(){j.identify(function(){j.checkGeo(function(){a()})})})):j.checkGeo(function(){a()})},j.identify=function(a){d({url:e.get("apiUrlNew")+"/user/info/v5/",method:"GET",success:function(b){b&&b.result&&b.result.id?(j.data.user=b.result,a()):j.error({text:"К сожалению, получить данные пользователя не удалось. Пожалуйста, обратитесь за помощью в службу поддержки Вашего оператора."})},error:function(){j.error({text:"К сожалению, получить данные пользователя не удалось. Пожалуйста, обратитесь за помощью в службу поддержки Вашего оператора."})}})},j.register=function(a){var b=decodeURIComponent(j.data.partner);b+=-1!==b.indexOf("?")&&b.indexOf("?")!==b.length-1?"&":"?",b+="mac="+gSTB.GetDeviceMacAddress()+"&device="+gSTB.GetDeviceModel(),d({url:b,method:"GET",success:function(b){b&&b.result&&b.result.session?(e.set("app_version",b.result.app_version),e.set("signKeyK",b.result.K),e.set("signKeyK1",b.result.K1),e.set("signKeyK2",b.result.K2),e.set("session",b.result.session),e.save(),j.data.session=b.result.session,a()):j.error({text:"Ошибка получения партнерских данных. Пожалуйста, обратитесь за помощью в службу поддержки Вашего оператора."})},error:function(){j.error({text:"Ошибка получения партнерских данных. Пожалуйста, обратитесь за помощью в службу поддержки Вашего оператора."})}})},j.checkGeo=function(a){d({url:e.get("apiUrl")+"/geocheck/whoami/v6/",method:"GET",data:{user_agent:""+window.encodeURIComponent(window.navigator.userAgent)},success:function(b){var c;b&&b.result&&b.result.actual_app_version?(e.set("app_version",b.result.actual_app_version),a()):(c=b&&b.error?334===b.error.code?"К сожалению, определить геоположение не удалось. Пожалуйста, обратитесь за помощью в службу поддержки Вашего оператора.":"К сожалению, приложение ivi недоступно в Вашей стране. Пожалуйста, обратитесь за помощью в службу поддержки Вашего оператора.":"К сожалению, определить геоположение не удалось. Пожалуйста, обратитесь за помощью в службу поддержки Вашего оператора.",j.error({text:c}))},error:function(){j.error({text:"К сожалению, определить геоположение не удалось. Пожалуйста, обратитесь за помощью в службу поддержки Вашего оператора."})}})},j.error=function(a){var b;i.init(["keydown","input"]),i.on("keydown",function(a){h.prepareEvent(a),(a.code===g.OK||a.code===g.BACK||a.code===g.EXIT)&&(window.parent!==window?window.parent.postMessage("hide","*"):window.location=h.getUrlParameters("referrer"))}),b=new f({handle:document.getElementById("error-modal"),visible:!0,model:{data:{title:"Ошибка",text:a.text},view:{handle:document.getElementById("error-modal"),template:!0}},active:!0,exitBtnHandle:".close",eventHandler:function(){return!0}})},b.exports=j},{"../config":40,"../modals/modal":"BjgSXc","./keys":"iIRFqq","./listener":"0gs5AI","./request":"oP21hV","./tools":"AjqgZI"}],"lib/partnership":[function(a,b,c){b.exports=a("+TvC+8")},{}],"lib/player":[function(a,b,c){
b.exports=a("LZDS0b")},{}],LZDS0b:[function(a,b,c){"use strict";var d=a("lib/emitter"),e=a("../config"),f={aspects:[{name:"exp",mode:0},{type:"fit",mode:16},{name:"big",mode:64},{name:"opt",mode:80}],init:function(){var a,b,c,d=this,f=Number(JSON.parse(gSTB.GetEnv(JSON.stringify({varList:["hdmi_event_delay"]}))).result.hdmi_event_delay);this.currentAspect=1,this.muted=0,gSTB.InitPlayer(),gSTB.SetAspect(this.aspects[this.currentAspect].mode),gSTB.SetVideoControl(0),gSTB.SetVideoState(0),gSTB.SetTopWin(0),gSTB.SetWinMode(0,0),gSTB.SetWinMode(1,0),gSTB.SetMode(0),gSTB.SetWinAlphaLevel(0,255),gSTB.SetWinAlphaLevel(1,255),gSTB.SetPIG(1,0,0,0),gSTB.SetAudioLangs(e.get("audioLang"),e.get("audioLang")),gSTB.SetSubtitleLangs(e.get("subtitlesLang"),e.get("subtitlesLang")),gSTB.SetSubtitlesFont(e.get("subtitlesFont"));try{e.set("videoMode",gSTB.RDir("vmode"))}catch(g){}stbEvent.onEvent=function(e){switch(d.emit("event",e),e){case"1":d.emit("end");break;case"2":d.totalTime=gSTB.GetMediaLenEx(),d.emit("info");break;case"4":d.emit("playStart");break;case"5":d.emit("error");break;case"7":break;case"32":clearTimeout(b),clearTimeout(a),f&&(a=setTimeout(function(){gSTB.GetStandByStatus()&&(gSTB.SetLedIndicatorMode(2),gSTB.StandBy(!1),c&&(d.emit("continue"),setTimeout(function(){gSTB.SetPosTime(c)},200)))},1e3*f));break;case"33":clearTimeout(b),clearTimeout(a),f&&(b=setTimeout(function(){gSTB.GetStandByStatus()||(gSTB.IsPlaying()?(c=gSTB.GetPosTime(),d.emit("pause")):c=0,gSTB.SetLedIndicatorMode(1),gSTB.StandBy(!0))},1e3*f))}}},start:function(a){gSTB.Play(a)},play:function(){gSTB.Continue()},pause:function(){gSTB.Pause()},stop:function(){gSTB.Stop()},setPosition:function(a){gSTB.SetPosTimeEx(a),gSTB.Continue()},getCurrentTime:function(){return gSTB.GetPosTimeEx()},isPlaying:function(){return gSTB.IsPlaying()},changeVolume:function(a){return a=gSTB.GetVolume()+a,a>100?a=100:0>a&&(a=0),gSTB.SetVolume(a),a},getVolume:function(){return gSTB.GetVolume()},mute:function(a){return void 0===a?this.muted=this.muted?0:1:this.muted=a?1:0,gSTB.SetMute(this.muted),this.muted},changeAspect:function(){var a;return this.currentAspect++,this.currentAspect>f.aspects.length-1&&(this.currentAspect=0),a=this.aspects[this.currentAspect],gSTB.SetAspect(a.mode),a}};d.inject(f),f.init(),b.exports=f},{"../config":40,"lib/emitter":"P7cBNP"}],oP21hV:[function(a,b,c){function d(a){var b,c,g,i,j,k=[],l=!1,m=!1;if(a=a||{},-1!==a.url.indexOf(f.get("contentApiUrl"))&&a.data&&"da.timestamp.get"!==a.data.method&&(a.data.method||"string"==typeof a.data&&-1===a.data.indexOf("da.timestamp.get"))&&(m=!0),a.url&&("string"==typeof a.url||a.url instanceof String)&&a.url.length>0){if(void 0!==a&&"object"==typeof a&&(a=h.defaults(a,d.defaults)),j=new XMLHttpRequest,(-1!==a.url.indexOf(f.get("apiUrl"))||-1!==a.url.indexOf(f.get("apiUrlNew")))&&(a.data=a.data||{},a.data.app_version=f.get("app_version"),f.get("session")&&(a.data.session=f.get("session"))),a.data&&"object"==typeof a.data)if("GET"===a.method){a.url+="?";for(i in a.data)if(a.data.hasOwnProperty(i)&&null!==a.data[i]&&void 0!==a.data[i])if(Array.isArray(a.data[i]))for(b=0;b<a.data[i].length;b++)k.push(i+"="+a.data[i][b]);else k.push(i+"="+a.data[i]);a.url+=k.join("&")}else"object"==typeof a.data&&(a.data=JSON.stringify(a.data));if(m&&(a.url=[f.get("contentApiUrl")+"?app_version="+f.get("app_version"),"ts="+e.currTimeStamp,"sign="+e.cmacbf(e.currTimeStamp+a.data)].join("&")),j.open(a.method,a.url,a.async!==!1),a.headers&&"object"==typeof a.headers)for(c=Object.keys(a.headers),b=0;b<c.length;b++)j.setRequestHeader(c[b],a.headers[c[b]]);return a.type&&(j.responseType=a.type),j.onreadystatechange=function(){var b;if(4===j.readyState){if(j.inAbort)return;if(l=j.status>=200&&j.status<300||304===j.status,clearTimeout(g),401===j.status){try{b=JSON.parse(j.responseText)}catch(c){b=""}if(b&&b.error&&b.error.ts)return e.currTimeStamp=b.error.ts,void d(a)}if(l){if("function"==typeof a.success)switch(a.dataType){case"json":try{b=JSON.parse(j.responseText)}catch(c){b=""}a.success.call(j,b,j.status);break;default:a.success(j.responseText)}}else"function"==typeof a.error&&a.error.call(j,j.statusText,j.status);"function"==typeof a.done&&a.done.call(j,j.responseText,j.status)}},j.send(a.data||null),g=setTimeout(function(){j.abort()},a.timeout),j.abort=function(){j.inAbort=!0,XMLHttpRequest.prototype.abort.call(j)},j}return!1}var e,f=a("../config"),g=a("./blowfish"),h=a("./tools");e={k:f.get("signKeyK"),k1:f.get("signKeyK1"),k2:f.get("signKeyK2"),currTimeStamp:"zygXj0oF5sg",init:function(){var a,b=[];for(this.k=f.get("signKeyK"),this.k1=f.get("signKeyK1"),this.k2=f.get("signKeyK2"),setTimeout(function(){d({url:f.get("contentApiUrl"),method:"POST",dataType:"json",headers:{"Content-Type":"application/json"},data:{method:"da.timestamp.get",params:[]},success:function(a){a&&a.result&&(e.currTimeStamp=a.result)},error:function(a){}})},1e3),e.K1=[],e.K2=[],e.BS=8,e.BF_K=new g,a=0;32>a;a+=2)b.push(parseInt(e.k.slice(a,a+2),16));for(e.BF_K.init(b),a=0;16>a;a+=2)e.K1.push(parseInt(e.k1.slice(a,a+2),16)),e.K2.push(parseInt(e.k2.slice(a,a+2),16))},cmacbf:function(a){var b,c,d,f,g,h,i,j,k,l,m,n=[0,0,0,0,0,0,0,0];for(b=a.length%e.BS==0?a.length-e.BS:a.length-a.length%e.BS,i=0;b>i;i+=e.BS){for(d=a.slice(i,i+e.BS),c=[],f=0;f<d.length;f++)c.push(d.charCodeAt(f)^n[f]);g=e.BF_K.encrypt_block(c),n=[g[3],g[2],g[1],g[0],g[7],g[6],g[5],g[4]]}if(j=a.slice(b),j.length==e.BS)h=e.K1;else for(h=e.K2,j+="",f=0;f<e.BS-j.length;f++)j+="\x00";for(k=[],f=0;f<e.BS;f++)k.push(j.charCodeAt(f)^n[f]^h[f]);for(l=e.BF_K.encrypt_block(k),l=[l[3],l[2],l[1],l[0],l[7],l[6],l[5],l[4]],m="",f=0;f<l.length;f++)i=l[f].toString(16),1==i.length&&(i="0"+i),m+=i;return m}},d.defaults={method:"GET",async:!0,headers:{},dataType:"json",data:null,timeout:1e4,error:null,done:null,success:null,url:""},d.sign=e,b.exports=d},{"../config":40,"./blowfish":"5JT8b3","./tools":"AjqgZI"}],"lib/request":[function(a,b,c){b.exports=a("oP21hV")},{}],"lib/rpc.client":[function(a,b,c){b.exports=a("PcZuZs")},{}],PcZuZs:[function(a,b,c){"use strict";function d(a,b){this._url=a,this._namespace=b,this._events={}}var e=a("lib/tools"),f=a("lib/request");d.prototype.call=function(a,b){var c,d,g=f({url:this._url,data:{method:this._namespace?this._namespace+"."+a:a,params:e.defaults(b,this.defParams)},method:"POST",dataType:"json",headers:{"Content-Type":"application/json"},success:function(a){a.error?d&&d(a.error):c&&c(a.result)},error:function(a){d&&d(a)}});return g.onSuccess=function(a){return c=a,g},g.onError=function(a){return d=a,g},g},b.exports=d},{"lib/request":"oP21hV","lib/tools":"AjqgZI"}],"8+NRr9":[function(a,b,c){"use strict";function d(a){this.defaults={container:document.body,indent:0},e.extend(this,e.defaults(a,this.defaults))}var e=a("./tools");d.prototype.show=function(a){a instanceof Node&&!(a.offsetHeight<=0&&a.offsetWidth<=0)&&(this.showY(a),this.showX(a))},d.prototype.showY=function(a){var b=a.offsetTop,c=a.offsetHeight,d=this.container.scrollTop,e=this.container.offsetHeight;d>b||c>e?this.scrollTop(b-this.indent):b+c>d+e&&this.scrollTop(b+c-e+this.indent)},d.prototype.showX=function(a){var b=a.offsetLeft,c=a.offsetWidth,d=this.container.scrollLeft,e=this.container.offsetWidth;d>b||c>e?this.scrollLeft(b+this.indent):b+c>d+e&&this.scrollLeft(b+c-e-this.indent)},d.prototype.scrollTop=function(a){this.container.scrollTop=a},d.prototype.scrollLeft=function(a){this.container.scrollLeft=a},b.exports=d},{"./tools":"AjqgZI"}],"lib/scroller":[function(a,b,c){b.exports=a("8+NRr9")},{}],"5cfm+n":[function(a,b,c){"use strict";function d(a){a.renders&&this.setRenders(a.renders||[]),a.template&&this.setTemplate(a.template)}var e=a("./dom");d.prototype.setTemplate=function(a){this._template=e.fragment(a)},d.prototype.setRenders=function(a){if(!Array.isArray(a))throw"Renders must be an Array";this._renders=a},d.prototype.addRender=function(a){this._renders.push(a)},d.prototype.compile=function(){var a,b,c,d,e,f,g,h,i={element:this._template.firstChild.cloneNode(!0),fields:{}};for(b=0;b<this._renders.length;b++)for(a=this._renders[b],e="data-"+a,g=i.element.querySelectorAll("["+e+"]"),c=0;c<g.length;c++)f=g[c],d=f.attributes.getNamedItem(e),h=d.value,void 0===i.fields[h]&&(i.fields[h]={}),void 0===i.fields[h][a]?i.fields[h][a]=[f]:i.fields[h][a].push(f);return i},b.exports=d},{"./dom":"CBUzS7"}],"lib/template":[function(a,b,c){b.exports=a("5cfm+n")},{}],mtNT1s:[function(a,b,c){"use strict";function d(a){this._hash=new Object(null),this.setType(a.type),this.setHash(a.data)}d.prototype.setType=function(a){this.type=a||Object},d.prototype.setHash=function(a){this.clear();for(var b in a)a.hasOwnProperty(b)&&this.set(b,a[b])},d.prototype.set=function(a,b){b instanceof this.type||(b=new this.type(b)),this._hash[a]=b},d.prototype.get=function(a){return this._hash[a]},d.prototype.remove=function(a){delete this._hash[a]},d.prototype.clear=function(){this._hash=new Object(null)},b.exports=d},{}],"lib/thash":[function(a,b,c){b.exports=a("mtNT1s")},{}],"lib/tools":[function(a,b,c){b.exports=a("AjqgZI")},{}],AjqgZI:[function(a,b,c){"use strict";function d(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]&&a[c].constructor===Object&&b[c]&&b[c].constructor===Object?d(a[c],b[c]):void 0===a[c]&&(a[c]=b[c]));return a}function e(a,b){return"function"==typeof a[b]?a[b].call(a):a[b]}function f(a,b){var c,d=b.indexOf(".");return-1!==d?(c=b.substr(0,d),f(a[c],b.substr(d+1))):e(a,b)}function g(a,b,c){return void 0!==a.code?!0:(a.code=a.keyCode||a.which,0===a.code?!1:(a.shiftKey&&(a.code+=1e3),a.altKey&&(a.code+=2e3),b!==!1&&a.stopPropagation(),!0))}function h(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function i(a,b,c){var d=c===!1?h({},a):a||{};for(var e in b)"object"!=typeof d[e]||"object"!=typeof b[e]||Array.isArray(d[e])||Array.isArray(b[e])?d[e]=b[e]:d[e]=i(d[e],b[e],c);return d}function j(a,b){var c=new Object(a);return"object"==typeof b&&h(c,b),c}function k(a,b){var c=1,d=function(){a.length===c&&"function"==typeof b?b():c++};Array.isArray(a)&&a.length>0?a.forEach(function(a){var b=new Image;b.src=a,b.onload=d,b.onerror=function(){throw"Image "+a+" load fail"}}):0===a.length&&b()}function l(a,b){return a.length>b&&(a=a.substr(0,b-3).trim()+"&nbsp;..."),a}function m(a){return("0"+a).slice(-2)}function n(a){return[m(a.getUTCHours()),m(a.getUTCMinutes()),m(a.getUTCSeconds())].join(":")}function o(){return o.index++}function p(a){var b,c,d={},e=window.location.search.split("?");if(-1===window.location.search.indexOf(a))return"";for(e=(e[1]||"").split("&"),c=0;c<e.length;c++){if(b=e[c].split("="),b[0]===a)return decodeURIComponent(b[1]);d[b[0]]=decodeURIComponent(b[1])}return d}function q(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);return c}if(!("classList"in document.documentElement)){var r=Array.prototype,s=r.indexOf,t=r.slice,u=r.push,v=r.splice,w=r.join;window.DOMTokenList=function(a){if(this._element=a,a.className!==this._classCache){if(this._classCache=a.className,!this._classCache)return;var b,c=this._classCache.replace(/^\s+|\s+$/g,"").split(/\s+/);for(b=0;b<c.length;b++)u.call(this,c[b])}},window.DOMTokenList.prototype={add:function(a){this.contains(a)||(u.call(this,a),this._element.className=t.call(this,0).join(" "))},contains:function(a){return-1!==s.call(this,a)},item:function(a){return this[a]||null},remove:function(a){var b=s.call(this,a);-1!==b&&(v.call(this,b,1),this._element.className=t.call(this,0).join(" "))},toString:function(){return w.call(this," ")},toggle:function(a){return this.contains(a)?this.remove(a):this.add(a),this.contains(a)}},Object.defineProperty(Element.prototype,"classList",{get:function(){return new window.DOMTokenList(this)}})}o.index=0,b.exports={extend:h,imageLoader:k,defaults:d,getValue:f,prepareEvent:g,extendDeep:i,create:j,result:e,values:q,ellipsis:l,uniqueID:o,prepareTime:n,prependZero:m,getUrlParameters:p}},{}],r32W0Q:[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={compiled:null,autoRender:!1,renders:{result:function(a){var c=g.result(b.model,a.key);h.value(a.element,c)},action:function(a){a.element.addEventListener("click",function(c){b.model.owner&&"function"==typeof b.model.owner[a.key]&&(b.model.owner[a.key](b.model),c.preventDefault())})},bind:function(a){var c=a.value||b.model.get(a.key)||"";h.value(a.element,c)},show:function(a){var c=void 0!==a.value?a.value:b.model.get(a.key);c?h.show(a.element):h.hide(a.element)},"style-width":function(a){var c=void 0!==a.value?a.value:b.model.get(a.key);a.element.style.width=c||""},"style-height":function(a){var c=void 0!==a.value?a.value:b.model.get(a.key);a.element.style.height=c||""},"class":function(a){var c=a.value||b.model.get(a.key),d=a.previous;d&&d.split(" ").forEach(function(b){a.element.classList.remove(b)}),c&&c.split(" ").forEach(function(b){a.element.classList.add(b)})}}},e.call(this,g.defaults(a,this.defaults)),a.template&&this.setTemplate(a.template),this.autoRender===!0&&this.template&&this.render()}var e=a("./view"),f=a("./template"),g=a("./tools"),h=a("./dom");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.addRender=function(a,b){this.renders[a]=b,this.template.addRender(a)},d.prototype.setTemplate=function(a){a instanceof f||(a&&a.nodeName||(a=this.handle?this.handle.children:null),a=new f({template:a,renders:Object.keys(this.renders)})),this.template=a},d.prototype.render=function(){this.update(),this.handle!==this.compiled.element&&this.insert(this.compiled.element)},d.prototype.update=function(){var a,b;for(null===this.compiled&&(this.compiled=this.compile()),b=Object.keys(this.compiled.fields),a=0;a<b.length;a++)this.updateField(b[a]);this.emit("onUpdate")},d.prototype.compile=function(){return this.compiled=this.template.compile(),this.emit("onCompile",this.compiled),this.compiled},d.prototype.updateField=function(a){var b,c,d,e;a=a.key?a:{key:a},e=this.compiled.fields[a.key];for(c in e)if(this.renders.hasOwnProperty(c))for(b=e[c],d=0;d<b.length;d++)this.renders[c](g.extend({element:b[d],attribute:c},a))},b.exports=d},{"./dom":"CBUzS7","./template":"5cfm+n","./tools":"AjqgZI","./view":"kWfdrx"}],"lib/tview":[function(a,b,c){b.exports=a("r32W0Q")},{}],kWfdrx:[function(a,b,c){"use strict";function d(a){this.defaults={saveDefault:!1,handle:null,owner:null,visible:!0},this._events=new Object(null),g.extend(this,g.defaults(a,this.defaults)),this.setHandle(this.handle),this.visible?this.show():this.hide(),this.saveDefault===!0&&(this.defaultHtml=this.handle.innerHTML)}var e=a("./emitter"),f=a("./dom"),g=a("./tools");d.prototype.setHandle=function(a){if(!(a instanceof Node))throw"Handler for view must be an Node or DocumentFragment";var b=this;this.handle=a,a.view=this,this.handle.addEventListener("click",function(a){b.emit("click",a)})},d.prototype.show=function(){f.show(this.handle),this.emit("show")},d.prototype.hide=function(){f.hide(this.handle),this.emit("hide")},d.prototype.toggle=function(){this.isVisible()?this.emit("hide"):this.emit("show"),f.toggle(this.handle)},d.prototype.html=function(a){this.emit("html",{old:this.handle.innerHTML,"new":a}),this.handle.innerHTML=a},d.prototype.getHandle=function(){return this.handle},d.prototype.insert=function(a){this.emit("insert",a.handle||a),this.clear(),this.handle.appendChild(a)},d.prototype.insertTo=function(a){return a=a.handle||a,this.emit("insertTo",a),f.clear(a),a.appendChild(this.handle)},d.prototype.appendChild=function(a){return a=a.handle||a,this.emit("appendChild",a),this.handle.appendChild(a)},d.prototype.appendTo=function(a){return a=a.handle||a,this.emit("onAppendTo",a),a.appendChild(this.handle)},d.prototype.insertBefore=function(a){return a=a.handle||a,this.emit("insertBefore",a),a.parentElement.insertBefore(this.handle,a)},d.prototype.clear=function(){this.emit("clear"),f.clear(this.handle)},d.prototype.remove=function(){this.emit("remove"),f.remove(this.handle)},d.prototype.restore=function(){this.emit("restore"),this.saveDefault===!0&&void 0!==this.defaultHtml&&(this.handle.innerHTML=this.defaultHtml)},d.prototype.isVisible=function(){return f.isVisible(this.handle)},e.inject(d),b.exports=d},{"./dom":"CBUzS7","./emitter":"P7cBNP","./tools":"AjqgZI"}],"lib/view":[function(a,b,c){b.exports=a("kWfdrx")},{}],"lib/watcher":[function(a,b,c){b.exports=a("/tW+0Y")},{}],"/tW+0Y":[function(a,b,c){"use strict";function d(a){this._events=new Object(null),this.setData(a),this.isPaused=!1}var e=a("./emitter");d.prototype.stop=function(){return this.data.off("changed",this._watch),this},d.prototype.pause=function(){return this.isPaused=!0,this},d.prototype.watch=function(){var a=this;return this.isPaused===!0&&(this.isPaused=!1),this.data.on("changed",function(b){a._watch(b)}),this},d.prototype._watch=function(a){this.isPaused||this.emit("watch",a)},d.prototype.setData=function(a){return this.data=a,this},e.inject(d),b.exports=d},{"./emitter":"P7cBNP"}],"modals/authorization":[function(a,b,c){b.exports=a("UgnP4x")},{}],UgnP4x:[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={name:"AuthorizationModal",visible:!1,active:!1,modal:!0,navigation:"horizontal"},f.call(this,j.defaults(a,this.defaults)),this.addComponent(new f({handle:document.getElementById("authorization-inputs-panel"),components:[this.email=new e({handle:document.getElementById("authorization-email-input"),events:{activate:function(){b.keyboard.activated=!0,b.keyboard.input=this}}}),this.password=new e({handle:document.getElementById("authorization-password-input"),events:{activate:function(){b.keyboard.activated=!0,b.keyboard.input=this}}}),new g({handle:document.getElementById("authorization-ok-button"),action:function(){h.authorize(b.email.value,b.password.value)},events:{activate:function(){b.keyboard.activated=!1}}}),new g({handle:document.getElementById("authorization-exit-button"),action:function(){b.hide()},events:{activate:function(){b.keyboard.activated=!1}}})]})),this.addComponent(this.keyboard=new i({name:"AuthorizationKeyboard",active:!0,owner:this,input:this.email,handle:document.getElementById("authorization-keyboard")})),this.addComponent(new g({activated:!1,active:!1,handle:document.getElementById("authorization-btn-close"),template:null,action:function(){b.hide()}})),this.on("show",function(){this.activate(),this.email.activate()}),this.on("hide",function(){this.deactivate()}),h.on("authorized",function(){b.hide()})}var e=a("components/input"),f=a("lib/cpanel"),g=a("components/button"),h=a("models/user"),i=a("components/keyboard"),j=a("lib/tools"),k=a("lib/keys");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.prototype.eventHandler=function(a){switch(a.code){case k.EXIT:return this.hide(),!0}return f.prototype.eventHandler.call(this,a),!0},b.exports=d},{"components/button":"+xiQfc","components/input":"7zX6co","components/keyboard":"A64hEq","lib/cpanel":"ySbxUr","lib/keys":"iIRFqq","lib/tools":"AjqgZI","models/user":"QAloAk"}],"modals/list":[function(a,b,c){b.exports=a("/X0zSk")},{}],"/X0zSk":[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={visible:!1,active:!1,template:!1,exitBtnHandle:a.handle.querySelector(".close"),contentHandle:a.handle.querySelector(".content"),content:[this.vlist=new f({active:!0,arrows:null,name:"SortRatingList",handle:a.handle.querySelector(".content"),collectionHandle:a.handle.querySelector(".list"),collection:{idName:"sort",data:a.list},events:{enter:function(a){"function"==typeof b.action&&b.action(a),b.emit("enter",a)}}})]},e.call(this,g.defaults(a,this.defaults))}var e=a("modals/modal"),f=a("components/vlist"),g=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.show=function(a){this.activateItem(a),this.view.show(),this.activate()},d.prototype.activateItem=function(a){this.vlist.activateItem(this.vlist.collection.get(a))},b.exports=d},{"components/vlist":"CJRc+3","lib/tools":"AjqgZI","modals/modal":"BjgSXc"}],BjgSXc:[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={modal:!0,active:!1,activated:!0,model:{data:a.data,view:{handle:a.handle,template:a.template||!1,watch:!0}}},e.call(this,h.defaults(a,this.defaults)),a.buttonsHandle&&("string"==typeof a.buttonsHandle&&(a.buttonsHandle=this.handle.querySelector(a.buttonsHandle)),this.addComponent(new e({active:!0,owner:this,activated:!0,handle:a.buttonsHandle,components:a.buttons,navigation:"horizontal"}))),a.contentHandle&&this.addComponent(new e({active:!0,handle:a.contentHandle,activated:!0,components:a.content})),a.exitBtnHandle&&("string"==typeof a.exitBtnHandle&&(a.exitBtnHandle=this.handle.querySelector(a.exitBtnHandle)),this.addComponent(new f({handle:a.exitBtnHandle,activated:!1,template:!1,action:function(){b.hide()}}))),this.on("hide",function(){this.deactivate()}),this.on("show",function(){this.activate()})}var e=a("lib/cpanel"),f=a("components/button"),g=a("lib/keys"),h=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.eventHandler=function(a){switch(a.code){case g.EXIT:return this.hide(),!0}return e.prototype.eventHandler.call(this,a),!0},b.exports=d},{"components/button":"+xiQfc","lib/cpanel":"ySbxUr","lib/keys":"iIRFqq","lib/tools":"AjqgZI"}],"modals/modal":[function(a,b,c){b.exports=a("BjgSXc")},{}],giot0N:[function(a,b,c){"use strict";function d(a){this.defaults={name:"AdvModel"},e.call(this,i.defaults(a,this.defaults)),this.rpcClient=new f(h.get("contentApiUrl"),h.get("advApiNamespace"))}var e=a("lib/model"),f=a("lib/rpc.client"),g=a("models/user"),h=a("../config"),i=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.getParams=function(){return{site:"s"+h.get("site"),watchid:this.get("watchid"),app_version:h.get("app_version"),advid:this.get("id"),uid:h.get("uid"),session:g.get("session")}},d.prototype.getFile=function(){var a,b,c=this.get("files"),d=h.get("videoQuality");if(!Array.isArray(c)||!c.length)return null;for(a=c.length;a&&(b=c[--a],!b.content_format||-1===b.content_format.indexOf(d)););return b.url},b.exports=d},{"../config":40,"lib/model":"blv/2e","lib/rpc.client":"PcZuZs","lib/tools":"AjqgZI","models/user":"QAloAk"}],"models/adv":[function(a,b,c){b.exports=a("giot0N")},{}],"7L3aGG":[function(a,b,c){"use strict";function d(a){this.defaults={posterSize:"172x264",events:{"budget_million:set":function(a){a.value&&(a.value=this._prepareMoney(a.value))},"artists:set":function(a){a.value.length&&(this.set("artists_short",a.value.slice(0,6).join(", ")+"&nbsp;..."),a.value=a.value.join(", "))},"description:set":function(a){a.value&&this.set("description_short",g.ellipsis(a.value,350))},"gross_world_million:set":function(a){a.value&&(a.value=this._prepareMoney(a.value))},"gross_usa_million:set":function(a){a.value&&(a.value=this._prepareMoney(a.value))}}},e.call(this,g.defaults(a,this.defaults))}var e=a("./film"),f=a("../dictionary"),g=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype._prepareMoney=function(a){var b,c,d=[],e=(1e6*parseInt(a)).toString().split("");for(b=0;b<e.length;b++)c=e[e.length-b-1],d[e.length-b-1]=b%3===0?c+" ":c;return d.join("")},d.prototype.details=function(){var a,b,c=this.get("year"),d=this.get("country"),e=this.get("duration_minutes"),g=this.get("genres"),h=[];if(c&&h.push(c),d=f.countries.get(d),d&&h.push(d.get("title")),g)for(a=0;a<g.length;a++)b=f.genres.get(g[a]),b&&h.push(b.get("title"));return e&&h.push(e+" минут"),h.join(", ")},b.exports=d},{"../dictionary":41,"./film":"DKEUaB","lib/tools":"AjqgZI"}],"models/film.info":[function(a,b,c){b.exports=a("7L3aGG")},{}],"models/film":[function(a,b,c){b.exports=a("DKEUaB")},{}],DKEUaB:[function(a,b,c){"use strict";function d(a){this.defaults={_data:{poster_originals:"img/"+(480===screen.height?576:screen.height)+"/video-preview.png"},posterSize:h.get("posterSize"),events:{"poster_originals:set":function(a){a.value.length&&(a.value=a.value[0].path+"/"+this.posterSize+"/")}}},e.call(this,i.defaults(a,this.defaults)),this.rpcClient=new g(h.get("contentApiUrl"),h.get("contentApiNamespace"))}var e=a("lib/model"),f=a("models/user"),g=a("lib/rpc.client"),h=a("../config"),i=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.load=function(a){var b,c=this;b=this.getRpcParams(),b.referrer="",this.inLoad=!0,this.loadXhr=this.rpcClient.call("get",[""+this.get("id"),b]).onSuccess(function(b){var d,e=h.get("videoQuality");c.set("files",b.files),d=ivi.playerPage.loggerData=b,c.set("watchid",b.watchid),c.watchid=b.watchid,"function"==typeof a&&a(),d.qualityId=0,d.watchedAdvs=[],d.sendContentWatched=!0;for(var f=0;f<d.files.length;f++)if(d.files[f].content_format&&-1!==d.files[f].content_format.indexOf(e)){d.qualityId=f;break}c.inLoad=!1,c.trigger("loaded")}).onError(function(a){c.inLoad=!1,c.trigger("loadError")})},d.prototype.watched=function(){this.isWatched=!0,this.trigger("watched")},d.prototype.getRpcParams=function(){var a=i.defaults({uid:h.get("uid"),site:"s"+h.get("site"),app_version:h.get("app_version"),session:f.get("session"),_domain:"",_url:"",campaignid:"",sourceid:""},this.reqParameters);return a},d.prototype.getFile=function(){var a,b,c=this.get("files"),d=h.get("videoQuality");if(!Array.isArray(c)||!c.length)return null;for(a=0;a<c.length&&(b=c[a],!b.content_format||-1===b.content_format.indexOf(d));a++);return b.url},d.prototype.abort=function(){this.loadXhr&&this.loadXhr.abort(),this.watchedXhr&&this.watchedXhr.abort()},b.exports=d},{"../config":40,"lib/model":"blv/2e","lib/rpc.client":"PcZuZs","lib/tools":"AjqgZI","models/user":"QAloAk"}],"models/promo":[function(a,b,c){b.exports=a("iVIYTP")},{}],iVIYTP:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.imageSize="372x163"}var e=a("lib/model");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.getImageUrl=function(){return this.get("images")["1024x449"].path+"/"+this.imageSize+"/"},b.exports=d},{"lib/model":"blv/2e"}],"models/serie":[function(a,b,c){b.exports=a("jiRtAe")},{}],jiRtAe:[function(a,b,c){"use strict";function d(a){this.defaults={posterSize:f.get("serialThumbSize"),events:{"thumb_originals:set":function(a){a.value.length&&this.set("thumbnail",a.value[0].path+"/"+this.posterSize+"/")}}},e.call(this,g.defaults(a,this.defaults))}var e=a("models/film"),f=a("../config"),g=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d},{"../config":40,"lib/tools":"AjqgZI","models/film":"DKEUaB"}],"models/user":[function(a,b,c){b.exports=a("QAloAk")},{}],QAloAk:[function(a,b,c){"use strict";function d(a){e.call(this,a||{}),this.authorized=!1}var e=a("lib/model"),f=(a("lib/tools"),a("lib/request")),g=a("../config");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.authorize=function(a,b){var c=this;return a&&b?(this.set("email",a),this.set("password",b),c.emit("request"),f({url:g.get("apiUrl")+"/login",data:{email:a,password:b},success:function(a){a.user?(c.setAll(a.user),g.set("session",a.user.session),c.authorized=!0,c.emit("authorized",a)):c.emit("authError",a.error)},error:function(a){c.emit("reqError",a)}}),!0):(c.emit("authError"),!1)},d.prototype.generateUID=function(){var a=Math.floor(1e8*Math.random());return a+"."+Date.now().toString().substr(-4)},d.prototype.logout=function(){this.clear(),this.authorized=!1,this.emit("logout")},d.prototype.isAuthorized=function(){return this.authorized===!0},b.exports=new d},{"../config":40,"lib/model":"blv/2e","lib/request":"oP21hV","lib/tools":"AjqgZI"}],u2t6GX:[function(a,b,c){"use strict";function d(a){this.defaults={name:"AgreementsPage",active:!1,visible:!1},e.call(this,g.defaults(a,this.defaults)),this.on("show",function(){this.header.setTitle("Пользовательское соглашение"),this.initFooter()})}var e=a("lib/cpage"),f=a("lib/keys"),g=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.initFooter=function(){this.footer.hideAll(),this.footer.showButton("exit","Назад")},d.prototype.eventHandler=function(a){if(a.code!==f.POWER&&e.prototype.eventHandler.call(this,a)===!0)return!0;switch(a.code){case f.UP:this.handle.scrollByLines(-1);break;case f.DOWN:this.handle.scrollByLines(1);break;case f.PAGE_UP:this.handle.scrollByLines(-20);break;case f.PAGE_DOWN:this.handle.scrollByLines(20);break;case f.POWER:return ivi.standBy(),!0}return!0},b.exports=d},{"lib/cpage":"B6eAZ7","lib/keys":"iIRFqq","lib/tools":"AjqgZI"}],"pages/agreements":[function(a,b,c){b.exports=a("u2t6GX")},{}],PcF5dW:[function(a,b,c){"use strict";function d(a){var b,c,d,r=this;this.defaults={name:"DetailsPage",active:!1,visible:!1,modelType:f,dynamic:!0,model:{view:{handle:a.handle,template:!0,watch:!0}}},e.call(this,s.defaults(a,this.defaults)),b=document.getElementById("details-tabs"),this.addComponent(this.buttonsPanel=new j({name:"Buttons",active:!0,activated:!0,owner:this,handle:b,navigation:"horizontal",components:[this.watchBtn=new i({name:"Watch Button",handle:b.querySelector(".watch"),template:!1,action:function(){r.play()},events:{activate:function(){r.watchPanel.show(),r.watchPanel.activate()},deactivate:function(){r.watchPanel.hide()}},eventHandler:function(a){if(i.prototype.eventHandler.call(this,a)===!0)return!0;var b=d.firstElementChild;switch(a.code){case q.UP:return 0===b.scrollTop?!1:(b.scrollByLines(-1),!0);case q.DOWN:return b.scrollByLines(1),!0}return!1}}),this.compilationButton=new i({name:"Compilations content Button",handle:b.querySelector(".compilation"),template:!1,active:!1,action:function(){r.compilationPanel.show()},events:{show:function(){this.activated=!0},hide:function(){this.deactivate(),this.activated=!1},activate:function(){r.compilationPanel.show(),r.compilationPanel.activate()},deactivate:function(){r.compilationPanel.hide(),r.compilationPanel.deactivate()}}}),this.reviewsButton=new i({name:"Reviews Button",handle:b.querySelector(".reviews"),template:!1,active:!1,action:function(){r.reviewsPanel.show()},events:{activate:function(){r.reviewsPanel.show(),r.reviewsPanel.activate()},deactivate:function(){r.reviewsPanel.hide()}}}),new i({name:"Similar Button",handle:b.querySelector(".similar"),template:!1,active:!1,action:function(){r.similarPanel.show()},events:{activate:function(){r.similarPanel.show(),r.similarPanel.activate()},deactivate:function(){r.similarPanel.hide()}}})]})),this.addComponent(this.contentPanel=new j({name:"Content panel",visible:!0,owner:this,navigation:"horizontal",active:!1,activated:!0,handle:document.getElementById("details-content"),events:{activate:function(){r.similarPanel.isActive()===!0?r.similarList.activate():r.reviewsPanel.isActive()===!0&&r.reviews.activate(),r.episodesList.hItems=null},deactivate:function(){r.similarList.deactivate(),r.reviews.deactivate()}}})),d=document.getElementById("details-watch-tab"),this.contentPanel.addComponent(this.watchPanel=new j({name:"Watch tab",activated:!1,visible:!0,handle:d})),c=document.getElementById("details-reviews-tab"),this.contentPanel.addComponent(this.reviewsPanel=new j({name:"Reviews tab",visible:!1,handle:c,components:[this.reviews=new g({handle:document.getElementById("details-reviews-list"),arrows:null,active:!1,scroller:{container:c.querySelector(".content")},collectionType:m,collection:{view:{template:!0,watch:!0},events:{fetch:function(a){a.length?(r.reviewsButton.show(),r.reviewsButton.activated=!0):(r.reviewsButton.hide(),r.reviewsButton.activated=!1)}}},events:{request:function(){r.startAction()},fetch:function(){r.endAction()},enter:function(a){r.reviewModal.showReview(a)}}})]})),this.contentPanel.addComponent(this.similarPanel=new j({name:"Similar panel",visible:!1,handle:document.getElementById("details-similar-tab"),components:[this.similarList=new h({name:"SimilarList",active:!1,visible:!0,handle:document.getElementById("details-similar-list"),collectionType:n,collection:{url:p.get("apiUrl")+"/video/related/",data:{count:30},events:{clear:function(){r.similarList.activeChild=null}}},collectionHandle:document.getElementById("details-similar-collection"),
events:{fetch:function(){r.endAction()},request:function(){r.startAction()},enter:function(a){r.manager.showDetails(a)},activate:function(){r.footer.showButton("info")},deactivate:function(){r.footer.hideButton("info")},showInfo:function(a){r.manager.showInfo(a)}}})]})),this.contentPanel.addComponent(this.compilationPanel=new j({name:"Compilation panel",visible:!1,navigation:"horizontal",handle:document.getElementById("details-compilation-tab"),components:[this.seasonsList=new g({name:"SeasonsList",active:!0,visible:!0,arrows:null,handle:document.getElementById("details-seasons-list"),view:{template:!0},collection:{events:{clear:function(){r.seasonsList.activeChild=null}}},events:{enter:function(a){r.seasonsList.activateItem(a)},activateItem:function(){r.episodesList.deactivateItem(r.episodesList.activeChild),r.episodesList.hide(),r.episodesList.update(),r.episodesList.show()},hide:function(){this.deactivate(),this.activated=!1,this.activeChild=null},show:function(){this.activated=!0,this.activate()}}}),this.episodesList=new k({name:"EpisodesList",active:!0,visible:!0,arrows:null,handle:document.getElementById("details-episodes-list"),collectionHandle:document.getElementById("details-episodes-collection"),collectionType:o,filter:function(a){return r.seasonsList.activeChild?a.get("season")===r.seasonsList.activeChild.get("season"):!0},previous:function(a,b){return this.activeChild.view.handle.offsetLeft<this.itemWidth&&!b?null:k.prototype.previous.call(this,a,b)},collection:{events:{clear:function(){this.reset(),r.episodesList.activeChild=null},fetch:function(){r.model.set("episodes",this.getArray())}}},events:{enter:function(a){r.play(a)}}})]})),this.reviewModal=new l({handle:document.getElementById("review-modal"),owner:this,template:!0,visible:!1,active:!1,exitBtnHandle:".close",showReview:function(a){this.model.set("title",a.get("title")),this.model.set("text",a.get("text")),this.show()},events:{init:function(){this.$text=this.handle.querySelector(".text")}},eventHandler:function(a){var b=0;switch(a.code){case q.UP:b=-1;break;case q.DOWN:b=1;break;case q.PAGE_UP:b=-5;break;case q.PAGE_DOWN:b=5;break;case q.EXIT:this.hide()}return this.$text.scrollByLines(b),!0}})}var e=a("lib/cpage"),f=a("models/film.info"),g=a("components/vlist"),h=a("components/hlist"),i=a("components/button"),j=a("lib/cpanel"),k=a("components/mclist"),l=a("modals/modal"),m=a("collections/reviews"),n=a("collections/films"),o=a("collections/series"),p=a("../config"),q=a("lib/keys"),r=a("lib/request"),s=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.prepare=function(a){this.startAction(),"number"==typeof a?this.loadFilm(a):(this.model.clear(),this.model.setAll(a.data),this.header.setTitle(this.model.get("title")),this.reviews.activeChild=null,this.initFooter(),this.model.get("seasons")?(this.type="compilation",this.compilationButton.show(),this.similarList.collection.url=p.get("apiUrl")+"/compilation/related/",this.loadCompilationReviews(this.model.get("ivi_id")),this.loadCompilationContent(this.model)):this.model.get("compilation")?(this.type="episode",this.compilationButton.show(),this.similarList.collection.url=p.get("apiUrl")+"/compilation/related/",this.loadCompilation(),this.loadCompilationReviews(this.model.get("id"))):(this.type="video",this.compilationButton.hide(),this.similarList.collection.url=p.get("apiUrl")+"/video/related/",this.loadVideoReviews()),this.buttonsPanel.activate(),this.watchBtn.activate(),this.loadSimilar()),this.endAction()},d.prototype.loadFilm=function(a){var b=this;this.startAction(),r({url:p.get("apiUrl")+"/videoinfo",data:{id:a},success:function(a){b.prepare({data:a}),b.endAction()},error:function(){b.trigger("error","Ошибка связи. Попробуйте позже."),b.endAction()}})},d.prototype.loadCompilation=function(){var a=this,b=this.model.get("compilation");this.startAction(),r({url:p.get("apiUrl")+"/compilationinfo",data:{id:b},success:function(c){b=new f({data:c}),a.model.set("compilation",b),a.loadCompilationContent(b),a.endAction()},error:function(){a.trigger("error","Ошибка связи. Попробуйте позже."),a.endAction()}})},d.prototype.loadCompilationReviews=function(a){this.reviews.collection.setType("compilation"),this.reviews.collection.fetch(a)},d.prototype.loadVideoReviews=function(){this.reviews.collection.setType("video"),this.reviews.collection.fetch(this.model.get("id"))},d.prototype.loadSimilar=function(){this.similarList.collection.setParameter("id",this.model.get("id")),this.similarList.collection.fullClear(),this.similarList.collection.fetch()},d.prototype.loadCompilationContent=function(a){a.get("seasons_count")?(this.loadCompilationSeasons(a.get("seasons")),this.episodesList.handle.classList.remove("single")):(this.seasonsList.hide(),this.episodesList.handle.classList.add("single"),this.episodesList.activate()),this.loadCompilationEpisodes(a.get("id"))},d.prototype.loadCompilationSeasons=function(a){var b,c,d,e=[];for(b=0,c=a.length;c>b;b++)d=a[b],e.push({title:"Сезон "+d,season:d});this.seasonsList.collection.models(e),this.seasonsList.show()},d.prototype.loadCompilationEpisodes=function(a){this.episodesList.collection.fullClear(),this.episodesList.collection.setParameter("id",a),this.episodesList.collection.fetch()},d.prototype.play=function(a){var b=this.model;"compilation"===this.type?(a||(a=this.episodesList.collection.at(0)),b.set("episode",a)):"episode"===this.type&&(a=this.episodesList.collection.get(this.model.get("id")),b=this.model.get("compilation"),b.set("episode",a),b.set("episodes",this.model.get("episodes"))),this.emit("showPlayer",b)},d.prototype.initFooter=function(){this.footer.hideAll(),this.footer.showButton("exit","Назад")},b.exports=d},{"../config":40,"collections/films":"MRwP1A","collections/reviews":"RbgBjM","collections/series":"uboD1Q","components/button":"+xiQfc","components/hlist":"GEj0De","components/mclist":"mKkleD","components/vlist":"CJRc+3","lib/cpage":"B6eAZ7","lib/cpanel":"ySbxUr","lib/keys":"iIRFqq","lib/request":"oP21hV","lib/tools":"AjqgZI","modals/modal":"BjgSXc","models/film.info":"7L3aGG"}],"pages/details":[function(a,b,c){b.exports=a("PcF5dW")},{}],"pages/genre":[function(a,b,c){b.exports=a("VmX1kv")},{}],VmX1kv:[function(a,b,c){"use strict";function d(a){var b=this,c=[],d={activateItem:function(a){b.infoFilm.isActive()&&b.infoFilm.update(a)},showInfo:function(a){b.manager.showInfo(a)},enter:function(a){b.manager.showDetails(a)},request:function(){b._allReady!==!0&&b.startAction()},fetch:function(){b._allReady!==!0&&b.endAction()},activate:function(){b.infoFilm.isVisible()||b.footer.showButton("info")}},i={activate:function(){b.footer.hideButton("info")}},m={activate:function(){this.activeChild instanceof h?b.footer.showButton("info"):b.footer.hideButton("info")}};this.defaults={name:"GenrePage",active:!1,dynamic:!0,visible:!1,owner:null,model:{},events:{allReady:function(){b._allReady=!0},hide:function(){b._allReady=!1}},arrows:{previous:".arrow.vertical.top",next:".arrow.vertical.bottom"}},e.call(this,k.defaults(a,this.defaults)),this.on("show",function(){var a=this.model.get("genre"),b=this.model.get("category"),c="category_id";a?(a=j.genres.get(a),b=j.categories.get(a.get(c)),this.header.setTitle(b.get("title")+"/"+a.get("title"))):b&&this.header.setTitle(j.categories.get(b).get("title"))}),this.addComponent(new f({handle:document.getElementById("genre-new-panel"),active:!0,activated:!0,events:m,components:[this.newButton=new g({handle:document.getElementById("genre-new-link"),template:null,action:function(){b.manager.showSorted(k.defaults(b.newList.collection.params,{sort:"new"}))},events:i}),this.newList=new h({name:"NewList",active:!0,sort:"new",autoLoad:!1,collectionHandle:document.getElementById("genre-new-collection"),handle:document.getElementById("genre-new-list"),events:d})]})),this.newButton.on("deactivate",function(){l.show(b.arrows.previous)}),this.newButton.on("activate",function(){l.hide(b.arrows.previous)}),c.push(this.newList),this.addComponent(new f({handle:document.getElementById("genre-popular-panel"),active:!1,activated:!0,events:m,components:[new g({active:!0,handle:document.getElementById("genre-popular-link"),template:null,action:function(){b.manager.showSorted(k.defaults(b.popList.collection.params,{sort:"pop"}))},events:i}),this.popList=new h({name:"PopularList",autoLoad:!1,collectionHandle:document.getElementById("genre-popular-collection"),handle:document.getElementById("genre-popular-list"),events:d})]})),c.push(this.popList),this.addComponent(new f({handle:document.getElementById("genre-rating-panel"),active:!1,activated:!0,events:m,components:[this.ratingTitle=new g({active:!0,handle:document.getElementById("genre-rating-link"),template:!0,watch:!0,title:"КиноПоиск",action:function(){b.manager.showRatingSort(b.ratingList.collection.params.sort,function(a){b.ratingTitle.setTitle(a.get("title")),b.ratingList.sortBy(a.get("sort"))})},events:i}),this.ratingList=new h({name:"RatingList",sort:"kp",autoLoad:!1,collectionHandle:document.getElementById("genre-rating-collection"),handle:document.getElementById("genre-rating-list"),events:d})]})),c.push(this.ratingList),this.addComponent(new f({handle:document.getElementById("genre-budget-panel"),active:!1,activated:!0,events:m,components:[this.budgetTitle=new g({active:!0,handle:document.getElementById("genre-budget-link"),template:!0,watch:!0,title:"по бюджету",action:function(){b.manager.showBudgetSort(b.budgetList.collection.params.sort,function(a){b.budgetTitle.setTitle(a.get("title")),b.budgetList.sortBy(a.get("sort"))})},events:i}),this.budgetList=new h({name:"BoxOfficeList",sort:"budget",autoLoad:!1,collectionHandle:document.getElementById("genre-budget-collection"),handle:document.getElementById("genre-budget-list"),events:d})]})),this.budgetList.on("deactivate",function(){l.show(b.arrows.next)}),this.budgetList.on("activate",function(){l.hide(b.arrows.next)}),c.push(this.budgetList),this.lists=c,this.on("show",function(){this.lists[0].activate(),this.initFooter()})}var e=a("lib/cpage"),f=a("lib/cpanel"),g=a("components/button"),h=a("components/hflist"),i=a("lib/collection"),j=a("../dictionary"),k=a("lib/tools"),l=a("lib/dom");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.prepare=function(a){var b;this.model.setAll(a);for(var c in this.lists)this.lists.hasOwnProperty(c)&&(b=this.lists[c].collection,k.extend(b.params,k.defaults(a,{category:null,genre:null,from:0,to:27,direction:1})),i.prototype.clear.call(b),b.fetch(),b.isEnd=!1,this.lists[c].activeChild=null)},d.prototype.initFooter=function(){this.footer.hideAll(),this.footer.showButton("exit","Назад"),this.footer.showButton("info","Подробней")},b.exports=d},{"../dictionary":41,"components/button":"+xiQfc","components/hflist":"qh3oth","lib/collection":"Ou0jNv","lib/cpage":"B6eAZ7","lib/cpanel":"ySbxUr","lib/dom":"CBUzS7","lib/tools":"AjqgZI"}],leTyfk:[function(a,b,c){"use strict";function d(a){var b=this,c={activateItem:function(a){b.infoFilm.isActive()&&b.infoFilm.update(a)},showInfo:function(a){b.manager.showInfo(a)},enter:function(a){b.manager.showDetails(a)},request:function(){b._allReady!==!0&&b.startAction()},fetch:function(){b._allReady!==!0&&b.endAction()},activate:function(){b.infoFilm.isVisible()||b.footer.showButton("info")}},d={activate:function(){b.footer.hideButton("info")}},m={activate:function(){this.activeChild instanceof i?b.footer.showButton("info"):b.footer.hideButton("info"),n.show(b.arrows.previous),n.show(b.arrows.next)}};this.defaults={name:"MainPage",active:!0,owner:null,dynamic:!0,events:{show:function(){this.header.setTitle(),this.initFooter(),this.manager.history=[]},allReady:function(){b._allReady=!0,b.dynamic=!1}},arrows:{previous:".arrow.vertical.top",next:".arrow.vertical.bottom"}},e.call(this,p.defaults(a,this.defaults)),this.addComponent(this.promoList=new h({name:"PromoList",active:!0,owner:this,collectionType:j,collectionHandle:document.getElementById("promo-collection"),handle:document.getElementById("promo-list"),events:{activate:function(){b.footer.hideButton("info"),n.hide(b.arrows.previous)},enter:function(a){b.manager.showDetails(a.get("content_id"))}}})),this.addComponent(this.historyPanel=new f({handle:document.getElementById("main-history-panel"),active:!1,visible:!1,activated:!1,events:m,components:[new g({handle:document.getElementById("main-history-link"),template:!1,activated:!0,active:!0,action:function(){b.manager.showUserData({tab:"history"})},events:d}),this.historyList=new i({name:"HistoryList",active:!1,activated:!0,autoLoad:!1,collection:{url:l.get("apiUrl")+"/watchhistory/",data:{session:k.get("session")}},events:c,collectionHandle:document.getElementById("history-collection"),handle:document.getElementById("history-list")})]})),k.on("authorized",function(){var a=b.historyList.collection;a.fullClear(),a.setParameter("session",k.get("session")),a.fetch(),b.historyPanel.activated=!0,a.once("fetch",function(){b.historyPanel.show()})}),k.on("logout",function(){b.historyPanel.isActive()&&b.promoList.activate(),b.historyPanel.hide(),b.historyList.clear(),b.historyPanel.activated=!1}),this.addComponent(new f({handle:document.getElementById("main-new-panel"),active:!1,activated:!0,events:m,components:[new g({handle:document.getElementById("main-new-link"),template:null,active:!0,action:function(){b.manager.showSorted({sort:"new",title:"Новинки"})},events:d}),this.newestList=new i({name:"NewList",sort:"new",collectionHandle:document.getElementById("films-new-collection"),handle:document.getElementById("films-new-list"),events:c})]})),this.addComponent(new f({handle:document.getElementById("main-popular-panel"),active:!1,activated:!0,events:m,components:[new g({active:!0,handle:document.getElementById("main-popular-link"),template:null,action:function(){b.manager.showSorted({sort:"pop",title:"Популярное"})},events:d}),this.popularList=new i({name:"PopularList",collectionHandle:document.getElementById("films-popular-collection"),handle:document.getElementById("films-popular-list"),events:c})]})),this.addComponent(new f({handle:document.getElementById("main-rating-panel"),active:!1,activated:!0,events:m,components:[this.ratingTitle=new g({active:!0,handle:document.getElementById("main-rating-link"),template:!0,watch:!0,title:"КиноПоиск",action:function(){b.manager.showRatingSort(b.ratingList.collection.params.sort,function(a){b.ratingTitle.setTitle(a.get("title")),b.ratingList.sortBy(a.get("sort"))})},events:d}),this.ratingList=new i({name:"RatingList",sort:"kp",collectionHandle:document.getElementById("films-rating-collection"),handle:document.getElementById("films-rating-list"),events:c})]})),this.addComponent(new f({handle:document.getElementById("main-budget-panel"),active:!1,activated:!0,events:m,components:[this.budgetTitle=new g({active:!0,handle:document.getElementById("main-budget-link"),template:!0,watch:!0,title:"по бюджету",action:function(){b.manager.showBudgetSort(b.budgetList.collection.params.sort,function(a){b.budgetTitle.setTitle(a.get("title")),b.budgetList.sortBy(a.get("sort"))})},events:d}),this.budgetList=new i({name:"BoxOfficeList",sort:"budget",collectionHandle:document.getElementById("films-budget-collection"),handle:document.getElementById("films-budget-list"),events:c})]})),this.budgetList.on("activate",function(){n.hide(b.arrows.next)}),o([function(a){b.promoList.collection.once("fetch",function(){a(null,"promoList")})},function(a){b.newestList.collection.once("fetch",function(){a(null,"newestList")})},function(a){b.popularList.collection.once("fetch",function(){a(null,"popularList")})},function(a){b.ratingList.collection.once("fetch",function(){a(null,"ratingList")})},function(a){b.budgetList.collection.once("fetch",function(){a(null,"budgetList")})}],function(a){b.emit("mainPageReady",{})}),this.initFooter()}var e=a("lib/cpage"),f=a("lib/cpanel"),g=a("components/button"),h=a("components/hlist"),i=a("components/hflist"),j=a("collections/promo"),k=a("models/user"),l=a("../config"),m=a("lib/keys"),n=a("lib/dom"),o=a("cjs-async/parallel"),p=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.initFooter=function(){this.footer.hideAll(),this.activeChild instanceof f&&this.activeChild.activeChild instanceof i&&this.footer.showButton("info","Подробнее"),this.footer.showButton("exit","Выход")},d.prototype.eventHandler=function(a){switch(a.code){case m.EXIT:return!1}return e.prototype.eventHandler.call(this,a)===!0},d.prototype.updateHistory=function(){this.historyList.reload()},b.exports=d},{"../config":40,"cjs-async/parallel":1,"collections/promo":"7uhHY+","components/button":"+xiQfc","components/hflist":"qh3oth","components/hlist":"GEj0De","lib/cpage":"B6eAZ7","lib/cpanel":"ySbxUr","lib/dom":"CBUzS7","lib/keys":"iIRFqq","lib/tools":"AjqgZI","models/user":"QAloAk"}],"pages/main":[function(a,b,c){b.exports=a("leTyfk")},{}],"pages/player":[function(a,b,c){b.exports=a("JjW+Ru")},{}],"JjW+Ru":[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={active:!1,dynamic:!0,visible:!1,panelHideInterval:5e3,posInterval:1e3,moveStep:6e4,changeTimeTimeout:500,reqParameters:{uid:m.get("uid"),site:m.get("site")},model:{data:{totalTime:48e4,currTimeTmp:28e4,watchedTime:0,panel:!0,advertising:!1,mute:!1,volume:!1,volumeLevel:h.getVolume()+"%"},events:{"currTimeTmp:set":function(a){var c,d;c=this.get("totalTime"),c&&a.value>c.getTime()?a.value=c.getTime()-1e3:a.value<0&&(a.value=0),a.value=new Date(a.value),d=Math.floor(a.value.getTime()/c.getTime()*100),this.set("currTimeTmpTxt",n.prepareTime(a.value)),this.set("currProgressTmp",d+"%"),b.inMove===!0&&b.setPosition(a.value.getTime())},"currTime:set":function(a){var c,d;c=this.get("totalTime"),c&&a.value>=c.getTime()?b.end():a.value<0&&(a.value=0),a.value=new Date(a.value),d=Math.floor(a.value.getTime()/c.getTime()*100),this.set("currTimeTxt",n.prepareTime(a.value)),this.set("currProgress",d+"%"),b.inMove!==!0&&this.set("currTimeTmp",a.value.getTime())},"totalTime:set":function(a){a.value=new Date(a.value),this.set("totalTimeTxt",n.prepareTime(a.value))}},view:{handle:a.handle,template:!0,watch:!0}},events:{show:function(){b.header.hide()},deactivate:function(){b.similarList.deactivate()}}},e.call(this,n.defaults(a,this.defaults)),this.addComponent(this.similarList=new i({name:"SimilarList",active:!1,visible:!1,handle:document.getElementById("similar-list"),collectionType:f,collection:{url:m.get("apiUrl")+"/video/related/",data:{count:30},events:{clear:function(){b.similarList.activeChild=null}}},collectionHandle:document.getElementById("similar-collection"),events:{activate:function(){b.showPanel(),this.show()},deactivate:function(){this.hide(),b.hidePanel(b.panelHideInterval)},enter:function(a){b.show(a,!1)},showInfo:function(){this.deactivate(),b.hidePanel()}},show:function(){this.handle.classList.remove("invisible")},hide:function(){this.handle.classList.add("invisible")}})),this.addComponent(this.seriesList=new i({name:"SeriesList",active:!1,visible:!1,handle:document.getElementById("series-list"),collectionType:g,collection:{events:{clear:function(){b.seriesList.activeChild=null}}},skip:function(a){return"divider"===a.get("type")},collectionHandle:document.getElementById("series-collection"),events:{activate:function(){b.showPanel(),this.show()},deactivate:function(){this.hide(),b.hidePanel(b.panelHideInterval)},enter:function(a){b.changeEpisode(a)},showInfo:function(){b.hidePanel(),this.deactivate()}},show:function(){this.handle.classList.remove("invisible")},hide:function(){this.handle.classList.add("invisible")}})),this.on("hide",function(){b.clear()}),h.on("end",function(){b.end()}),h.on("pause",function(){b.pause()}),h.on("continue",function(){b.play()}),h.on("error",function(){b.clear(),b.emit("error","Во время воспроизведения возникла ошибка. Пожалуйста повторите попытку позже."),b.logger({server:"google",type:"Linkerror",videoId:b.watchid,serverId:b.loggerData.google_analytics_id})}),this.advModal=new j({owner:this,handle:document.getElementById("adv-modal"),list:new l,visible:!1,show:function(a){var c,d,e={2:25,5:50,7:75,10:100},f=[],g=[],i=0,k=0;if(this._advs=a,clearInterval(this.advTimer),a&&a.length){for(b.model.set("adv_total",a.length),b.model.set("adv_current",0),b.model.set("advertising",!0),this.currTime=h.getCurrentTime(),c=0;c<a.length;c++)k+=a[c].get("duration")||15,f.push(a[c].get("duration")||15),g.push(a[c]);h.once("playStart",function(){clearInterval(b.advModal.timeTimer),b.advModal.timeTimer=setInterval(function(){b.advModal.advLoaded&&(--k,b.model.set("adv_time",k),f.length&&f[0]&&(--f[0],++i,d=Math.round(i/(g[0].get("duration")||15)*10),g[0].get("px_audit_"+e[d])&&(b.logger({server:"pixel-audit",url:g[0].get("px_audit_"+e[d])}),g[0].set("px_audit_"+e[d],null)),f[0]||(f.shift(),g.shift(),i=0,b.advModal.advLoaded=!1))),0>=k&&clearInterval(b.advModal.timeTimer)},1e3)}),this.play()}b.hidePanel(),j.prototype.show.call(this)},hide:function(){this.deactivate(),j.prototype.hide.call(this)},load:function(a,b,c){this.list.load(a,b,c)},play:function(){var a,c=b.model.get("adv_current");this._advs&&this._advs.length&&(b.model.set("adv_current",++c),this.adv=this._advs.shift(),this.list.remove(this.adv),b.loggerData.sendContentWatched&&(b.loggerData.sendContentWatched=!1,b.logger({server:"digitalaccess"})),this.adv.trigger("watched"),a=this.adv.get("px_audit"),"string"!=typeof a&&a||(a=[a]),a.forEach(function(a){b.logger({server:"pixel-audit",url:a})}),h.stop(),b.setState(this.adv.get("type")),b.loggerData.watchedAdvs.push(this.adv.get("id")),b.logger({server:"google",type:this.adv.get("type"),videoId:b.watchid,serverId:b.loggerData.google_analytics_id}),h.on("playStart",function(){b.advModal.advLoaded=!0}),h.start(this.adv.getFile()))},advInQueue:function(){return this._advs&&this._advs.length},end:function(){this._advs&&this._advs.length?this.play():(b.advModal.setCurrent([]),this.hide(),b.play())},startTimer:function(a){},setCurrent:function(a){this._advs=a},eventHandler:function(a){return-1===[p.EXIT,p.VOLUME_DOWN,p.VOLUME_UP,p.MUTE,p.FRAME].indexOf(a.code)},clear:function(){this.list.abort(),clearTimeout(this.midroleTimer),clearInterval(this.timeTimer)}}),this.advModal.list.on("loaded",function(){b.start()}),this.advModal.list.on("loadError",function(){b.start()})}var e=a("lib/cpage"),f=a("collections/films"),g=a("collections/series"),h=a("lib/player"),i=a("components/hlist"),j=a("modals/modal"),k=a("models/user"),l=a("collections/adv"),m=a("../config"),n=a("lib/tools"),o=a("lib/request"),p=a("lib/keys");d.states=["preparing","playing","paused","watched","preroll","postroll","midroll","pauseroll"],d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.play=function(){var a,b,c=this,d=this.model.get("film"),e=(Number(this.loggerData.credits_begin_time)||Number(this.loggerData.duration))-60,f=[5,15,60,120>e?120:e,Number(this.loggerData.duration)],g=[1,3,5,60,5],i=this.state;switch(this.setState("preparing"),i){case"preparing":case"preroll":h.once("info",function(){c.markerIndex=0,c.model.set("totalTime",h.totalTime),c.markerTimer=setTimeout(function a(){var b;c.model.get("currTime")&&(b=Math.floor(c.model.get("currTime").getTime()/1e3),b<Math.floor(h.totalTime/1e3)?("paused"!==c.state&&(b<=f[c.markerIndex]?c.logger({server:"digital-logger",type:"contentTimer",contentid:c.model.get("film").get("id")}):c.markerIndex++),clearTimeout(c.markerTimer),c.markerTimer=setTimeout(a,1e3*g[c.markerIndex])):c.logger({server:"digital-logger",type:"contentTimer",contentid:c.model.get("film").get("id")}))},1e3*g[c.markerIndex])}),h.once("playStart",function(){c.startTimer(),c.setState("playing"),c.showPanel(c.panelHideInterval),c.synchronizeTime(),c.trigger("contentStart")}),h.stop(),h.start(d.getFile()),c.logger({server:"google",type:"Start",videoId:c.watchid,serverId:c.loggerData.google_analytics_id}),c.logger({server:"tns-counter",type:"playstart",serverId:c.loggerData.tns_id}),c.logger({server:"digital-logger",type:"event",type_id:"1",videoId:c.loggerData.id}),c.loggerData.sendContentWatched&&(c.loggerData.sendContentWatched=!1,c.logger({server:"digitalaccess"}));break;case"paused":a=this.advModal.list.getByType("pauseroll"),b=a[0],b?this.advModal.show([b]):(this.setState("playing"),this.model.set("state","pause"),h.play(),this.hidePanel(this.panelHideInterval));break;case"pauseroll":case"midroll":h.stop(),h.once("playStart",function(){h.pause(),h.setPosition(c.advModal.currTime),c.setState("playing")}),h.start(d.getFile())}},d.prototype.pause=function(){this.setState("paused"),h.pause(),this.showPanel(),this.logger({server:"google",type:"Pause",videoId:this.watchid,serverId:this.loggerData.google_analytics_id})},d.prototype.setState=function(a){-1!==d.states.indexOf(a)&&(this.state=a)},d.prototype.prepare=function(a){var b,c,d,e=this,f=a.get("id"),g=a.get("episodes");this.startAction("prepare"),h.once("playStart",function(){e.endAction("prepare")}),this.setState("preparing"),this.model.reset(),g?(b=a.get("title")+" ( ",d=a,this.model.set("compilation",d),a=a.get("episode")||a,c=a.get("season"),c&&(b+=c+" сезон "),b+=" "+a.get("title")+" )",this.type="compilation",this.prepareCompilation(g,d.get("seasons_count")),this.seriesList.activated=!0,this.similarList.activated=!1,this.activeList=this.seriesList):(this.type="film",b=a.get("title"),this.similarList.collection.setParameter("id",f),this.similarList.collection.fetch(),this.seriesList.activated=!1,this.similarList.activated=!0,this.activeList=this.similarList),this.model.setAll({title:b,id:f,film:a,watchedTime:0,voluem:!1}),this.seriesList.hide(),this.similarList.hide(),this.advModal.hide(),a.inLoad=!0,this.advModal.list.inLoad=!0,this.loadFilm(a,function(){setTimeout(function(){e.watchid=a.get("watchid"),e.advModal.load(a.get("id"),e.watchid,"preroll")},500)})},d.prototype.changeEpisode=function(a){var b=this.model.get("compilation");this.startAction(),this.showPanel(),clearTimeout(this.hidePanelTimeout),b.set("episode",a),h.stop(),this.seriesList.deactivate(),this.prepare(b),this.endAction()},d.prototype.getEpisode=function(a){var b=this.seriesList.collection,c=this.model.get("film"),d=b.get(c.get("id")),e=b.indexOf(d);return b.at(e+a)},d.prototype.previousEpisode=function(){var a=this.getEpisode(-1);a&&this.changeEpisode(a)},d.prototype.nextEpisode=function(){var a=this.getEpisode(1);a?this.changeEpisode(a):this.exit()},d.prototype.prepareCompilation=function(a,b){if(b){var c,d=1;for(a.sort(function(a,b){return a.season-b.season||a.episode-b.episode}),a[0].type="first";c=a[d];)c.season!==a[d-1].season&&(c.type="first"),d++}this.seriesList.collection.models(a)},d.prototype.hidePanel=function(a){var b=this;clearTimeout(this.hidePanelTimeout),a&&this.activeList.isActive()||(this.hidePanelTimeout=setTimeout(function(){b.model.set("panel",!1),b.footer.hide()},a||0))},d.prototype.showPanel=function(a){clearTimeout(this.hidePanelTimeout),this.model.set("panel",!0),this.model.set("state",h.isPlaying()?"pause":"play"),this.footer.show(),a&&this.hidePanel(a)},d.prototype.loadFilm=function(a,b){var c=this;a.once("loaded",function(){c.start(),c.logger({server:"tns-counter",type:"player",serverId:c.loggerData.tns_id})}),a.once("loadError",function(){c.trigger("error","Ошибка связи. Попробуйте позже.")}),a.load(b)},d.prototype.filmWatched=function(){var a=this.model.get("film");a.watched(),clearTimeout(this.markerTimer)},d.prototype.startTimer=function(){var a,b=this;clearInterval(this.positionTimer),this.positionTimer=setInterval(function(){h.isPlaying()&&"playing"===b.state&&(a=b.model.get("currTime").getTime()+b.posInterval,b.model.set("currTime",a),a=b.model.get("watchedTime")+1,b.logTime())},this.posInterval)},d.prototype.setPosition=function(a){var b=this;clearTimeout(this.changeTimeTimer),this.changeTimeTimer=setTimeout(function(){h.once("playStart",function(){"paused"===b.state&&h.pause(),b.synchronizeTime()}),h.setPosition(a)},this.changeTimeTimeout)},d.prototype.synchronizeTime=function(){var a=h.getCurrentTime();this.model.set("currTime",a),this.inMove=!1},d.prototype.end=function(){var a=this;switch(this.state){case"preroll":case"midroll":case"pauseroll":this.advModal.end();break;case"playing":this.advModal.list.loadMore(this.advModal.list.filmId,this.advModal.list.watchid,"postroll",function(){var b=a.advModal.list.getByType("postroll");Array.isArray(b)&&b.length?a.advModal.show(b):"compilation"===a.type?a.nextEpisode(1):(a.logger({server:"google",type:"End",videoId:a.watchid,serverId:a.loggerData.google_analytics_id}),a.logger({server:"tns-counter",type:"playend",serverId:a.loggerData.tns_id}),a.exit())});break;case"preparing":this.play();break;case"postroll":this.advModal.advInQueue()?this.advModal.end():(this.filmWatched(),"compilation"===this.type?this.nextEpisode(1):this.exit())}},d.prototype.start=function(){var a,b,c=this,d=this.advModal.list,e=this.model.get("film");this.setState("preparing"),this.model.set("state","pause"),!e||e.inLoad||d.inLoad||(this.stop(),a=e.getFile(),a?(this.model.set("currTime",0),this.model.set("currTimeTmp",0),b=d.getByType("preroll"),Array.isArray(b)&&b.length?this.advModal.show(b):this.play(),this.once("contentStart",function(){c.advModal.startTimer()})):this.trigger("error","Запрашиваемый контент не найден."))},d.prototype.stop=function(){clearInterval(this.positionTimer),h.stop()},d.prototype.moveLeft=function(a){var b=this,c=this.model.get("currTimeTmp").getTime()-this.moveStep*(a||1);clearTimeout(this.changeTimeTimer),clearTimeout(this.logRewindTimer),this.logRewindTimer=setTimeout(function(){b.markerIndex=0,b.logger({server:"digital-logger",type:"event",type_id:"3",videoId:b.loggerData.id})},2*this.changeTimeTimeout),this.showPanel(this.panelHideInterval),this.showTimeNotification(),this.inMove=!0,this.model.set("currTimeTmp",c)},d.prototype.moveRight=function(a){var b=this,c=this.model.get("currTimeTmp").getTime()+this.moveStep*(a||1);clearTimeout(this.changeTimeTimer),clearTimeout(this.logRewindTimer),this.logRewindTimer=setTimeout(function(){b.markerIndex=0,b.logger({server:"digital-logger",type:"event",type_id:"3",videoId:b.loggerData.id})},2*this.changeTimeTimeout),this.showPanel(this.panelHideInterval),this.showTimeNotification(),this.inMove=!0,this.model.set("currTimeTmp",c)},d.prototype.showTimeNotification=function(){var a=this;this.model.set("notifyShow",!0),clearTimeout(this.hideTimeNotification),this.hideTimeNotification=setTimeout(function(){a.model.set("notifyShow",!1)},1e3)},d.prototype.logTime=function(){var a,b=[],c=this.model.get("film"),d=this.model.get("watchedTime")+1,e={contentid:c.get("id"),watchid:encodeURIComponent(this.watchid),iviuid:k.get("id"),site:"s"+m.get("site"),uid:encodeURIComponent(m.get("uid")),fromstart:Math.floor(this.model.get("currTime").getTime()/1e3),seconds:d},f=Math.floor(h.totalTime/4/1e3),g=this;for(a in e)e.hasOwnProperty(a)&&b.push(a+"="+e[a]);(e.fromstart===f||e.fromstart===2*f||e.fromstart===3*f)&&g.logger({server:"google",type:String(25*e.fromstart/f),videoId:g.watchid,serverId:g.loggerData.google_analytics_id}),-1!==(g.loggerData.midroll||[]).indexOf(e.fromstart)&&(g.loggerData.midroll.splice(g.loggerData.midroll.indexOf(e.fromstart),1),g.advModal.list.loadMore(g.advModal.list.filmId,g.advModal.list.watchid,"midroll",function(){var a=g.advModal.list.getByType("midroll");Array.isArray(a)&&a.length&&"playing"===g.state&&g.advModal.show(a)})),this.model.set("watchedTime",d)},d.prototype.mute=function(a){a&&this.model.set("volumeLevel","0%"),this.model.set("mute",h.mute(a))},d.prototype.changeVolume=function(a){var b=this;this.model.set("volume",!0),this.model.set("volumeLevel",h.changeVolume(a)+"%"),this.mute(!1),clearInterval(this.hideVolumeTimeout),this.hideVolumeTimeout=setTimeout(function(){b.model.set("volume",!1)},2e3)},d.prototype.clear=function(){var a=this.model.get("film");clearInterval(this.positionTimer),clearTimeout(this.changeTimeTimer),clearTimeout(this.hidePanelTimeout),this.header.show(),
this.footer.show(),this.advModal.clear(),a&&!a.isWatched&&a.abort(),this.similarList.collection.abort(),this._startedActions=0,h.stop()},d.prototype.exit=function(){this.filmWatched(),this.trigger("updateHistory"),this.manager.back()},d.prototype.eventHandler=function(a){if(a.code!==p.EXIT&&a.code!==p.POWER&&e.prototype.eventHandler.call(this,a)===!0)return!0;if(a.code===p.INFO)return this.model.get("panel")?this.hidePanel():this.showPanel(this.panelHideInterval),!0;switch(a.code){case p.UP:this.activeList.activate();break;case p.DOWN:this.activeList.deactivate();break;case p.LEFT:this.moveLeft();break;case p.RIGHT:this.moveRight();break;case p.FORWARD:this.moveRight(5);break;case p.REWIND:this.moveLeft(5);break;case p.PAGE_UP:return"compilation"===this.type&&this.previousEpisode(),!0;case p.PAGE_DOWN:return"compilation"===this.type&&this.nextEpisode(),!0;case p.FRAME:return h.changeAspect(),!0;case p.MUTE:return this.mute(),!0;case p.VOLUME_UP:return this.changeVolume(5),!0;case p.VOLUME_DOWN:return this.changeVolume(-5),!0;case p.OK:case p.PLAY_PAUSE:h.isPlaying()?this.pause():(this.showPanel(this.panelHideInterval),this.play());break;case p.POWER:return ivi.standBy(),!0;case p.EXIT:return this.activeList.isActive()?(this.activeList.deactivate(),!0):(this.exit(),!0)}return!0},d.prototype.logger=function(a){var b={};switch(a.server){case"tns-counter":if(!a.serverId||"NaN"===a.serverId)return;b.url="http://www.tns-counter.ru/V13a****ivi_ru/ru/CP1251/tmsec="+a.serverId+"_"+a.type+"/",b.method="GET";break;case"pixel-audit":if(!a.url)return;b.url=a.url,b.method="GET";break;case"google":var c,d=(new Date).getTime();a.type=a.type.charAt(0).toUpperCase()+a.type.substr(1),c="http://www.google-analytics.com/__utm.gif?utmwv=4.3as&utmn="+d+"&utmhn=localhost&utmt=event&utme=5(Video*"+a.type+")",c+="&utmcs=UTF-8&utmcs=UTF-8&utmsr="+screen.width+screen.height+"&utmsc=24-bit&utmul=ru&utmje=&utmfl=&utmdt=&utmhid=",c+=d+"&utmr=-&utmp=&utmac="+a.serverId+"&utmcc=__utma%3D"+a.videoId+"_"+d+"."+d+".29%3B%2B__utmz%3D",c+=a.videoId+"_"+d+"."+d+".1.1.utmcsr%3D(direct)%7Cutmccn%3D(direct)%7Cutmcmd%3D(none)%3B",b.url=c,b.method="GET";break;case"digitalaccess":b.data={method:"da.content.watched",params:[this.loggerData.id,{watchid:encodeURIComponent(this.watchid),site:"s"+m.get("site"),uid:m.get("uid"),app_version:m.get("app_version"),session:k.get("session"),_domain:"",_url:"",campaignid:"",sourceid:""}]},b.url=m.get("contentApiUrl");break;case"digital-logger":"event"===a.type&&(b.data={seconds:this.model.get("watchedTime"),watchid:encodeURIComponent(this.watchid),site:"s"+m.get("site"),app_version:m.get("app_version"),uid:encodeURIComponent(m.get("uid")),type_id:a.type_id,duration:1,content_format:"mp4-"+m.get("videoQuality"),fromstart:Math.floor(this.model.get("currTime").getTime()/1e3),contentid:a.videoId,device:m.get("deviceModel")},b.url=m.get("logApiUrl")+"content/load/"),"contentTimer"===a.type&&(b.data="seconds="+encodeURIComponent(this.model.get("watchedTime")),b.data+="&watchid="+encodeURIComponent(this.watchid),b.data+="&app_version="+encodeURIComponent(m.get("app_version")),b.data+="&uid="+encodeURIComponent(m.get("uid")),b.data+="&contentid="+encodeURIComponent(a.contentid),b.data+="&fromstart="+encodeURIComponent(Math.floor(this.model.get("currTime").getTime()/1e3)),k.isAuthorized()&&(b.data+="&iviuid="+encodeURIComponent(k.get("id"))),b.data=b.data.replace(/\./g,"%2E"),b.data=b.data.replace(/_/g,"%5F"),b.contentType="application/x-www-form-urlencoded",b.url=m.get("log2ApiUrl")+"content/time/")}o({url:b.url,method:b.method||"POST",data:b.data,headers:{"Content-type":b.contentType||"application/json"}})},b.exports=d},{"../config":40,"collections/adv":"4eSXXB","collections/films":"MRwP1A","collections/series":"uboD1Q","components/hlist":"GEj0De","lib/cpage":"B6eAZ7","lib/keys":"iIRFqq","lib/player":"LZDS0b","lib/request":"oP21hV","lib/tools":"AjqgZI","modals/modal":"BjgSXc","models/user":"QAloAk"}],"pages/profile":[function(a,b,c){b.exports=a("B3R0cH")},{}],B3R0cH:[function(a,b,c){"use strict";function d(a){var b=this,c={enter:function(a){b.manager.showDetails(a)},request:function(){b.startAction()},fetch:function(){b.endAction()}},d=[{title:"Очередь на просмотр",type:"focus-tab",panel:"queue"},{title:"История просмотров",type:"focus-tab",panel:"history"},{title:"Настройки",type:"focus-tab",panel:"settings"}];j.data.user||d.push({title:"Выход",type:"btn_tab",panel:"exit",action:function(){i.logout()}}),this.defaults={name:"ProfilePage",active:!1,visible:!1,dynamic:!0,model:{view:{handle:a.handle,template:!0,watch:!0}}},f.call(this,l.defaults(a,this.defaults)),this.addComponent(this.tabsList=new h({name:"Profile tabs",active:!1,activated:!0,arrows:null,hItems:4,collection:{idName:"panel",data:d},events:{activateItem:function(a){var b=this.panels[a.get("panel")];b.show(),b.activate()},deactivateItem:function(a){var b=this.panels[a.get("panel")];b.hide()},enter:function(a){this.activateItem(a),a.get("action")&&a.get("action")()}},handle:document.getElementById("profile-tabs-list")})),this.addComponent(this.contentPanel=new g({name:"Content panel",visible:!0,owner:this,navigation:"horizontal",active:!1,activated:!0,handle:document.getElementById("profile-content")})),this.contentPanel.addComponent(this.queuePanel=new g({name:"Watch tab",activated:!0,visible:!0,handle:document.getElementById("profile-queue-panel"),components:[this.queueList=new e({name:"QueueList",active:!0,activated:!0,autoLoad:!1,collection:{url:k.get("apiUrl")+"/user/favourites/"},events:c,collectionHandle:document.getElementById("profile-queue-collection"),handle:document.getElementById("profile-queue-list")})],events:{activate:function(){b.queueList.trigger("activate")}}})),this.contentPanel.addComponent(this.historyPanel=new g({name:"Watch tab",activated:!0,visible:!1,handle:document.getElementById("profile-history-panel"),components:[this.historyList=new e({name:"HistoryList",active:!0,activated:!0,autoLoad:!1,collection:{url:k.get("apiUrl")+"/watchhistory/",data:{session:i.get("session")}},events:c,collectionHandle:document.getElementById("profile-history-collection"),handle:document.getElementById("profile-history-list")})],events:{activate:function(){b.historyList.trigger("activate")}}})),this.contentPanel.addComponent(this.settingsPanel=new g({name:"Settings tab",activated:!0,visible:!1,handle:document.getElementById("profile-settings-panel"),components:[this.qualityList=new h({name:"QualitySelector",active:!0,activated:!0,autoLoad:!1,arrows:null,collection:{idName:"quality",data:[{title:"Низкое",quality:"mobile",type:"btn_left"},{title:"Среднее",quality:"low"},{title:"Высокое",quality:"hi",type:"btn_right"}],view:{template:!0,watch:!0}},collectionHandle:document.getElementById("profile-quality-collection"),handle:document.getElementById("profile-quality-list")})]})),b.qualityList.activateItem(b.qualityList.collection.get(k.get("videoQuality"))),this.qualityList.on("activateItem",function(a){k.set("videoQuality",a.get("quality"))}),k.on("load",function(){b.qualityList.activateItem(b.qualityList.collection.get(k.get("videoQuality")))}),this.contentPanel.addComponent(this.exitPanel=new g({name:"Exit tab",activated:!0,visible:!1,handle:document.getElementById("profile-exit-panel")})),this.tabsList.panels={queue:this.queuePanel,history:this.historyPanel,settings:this.settingsPanel,exit:this.exitPanel},this.tabsList.activate(),i.on("logout",function(){b.manager.show(b.manager.main())}),this.on("show",function(){this.videoQuality=k.get("videoQuality")}),this.on("hide",function(){this.videoQuality!==k.get("videoQuality")&&k.save()})}var e=a("components/hflist"),f=a("lib/cpage"),g=a("lib/cpanel"),h=a("components/hlist"),i=a("models/user"),j=a("lib/partnership"),k=a("../config"),l=a("lib/tools");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.prototype.prepare=function(a){this.startAction(),a&&a.tab&&this.showTab(a.tab),this.prepareList(this.historyList),this.prepareList(this.queueList),this.endAction()},d.prototype.updateHistory=function(){this.historyList.reload()},d.prototype.showTab=function(a){this.tabsList.activateItem(this.tabsList.collection.get(a))},d.prototype.prepareList=function(a){a.collection.fullClear(),a.collection.setParameter("session",i.get("session")),a.activeChild=null,a.collection.fetch()},b.exports=d},{"../config":40,"components/hflist":"qh3oth","components/hlist":"GEj0De","lib/cpage":"B6eAZ7","lib/cpanel":"ySbxUr","lib/partnership":"+TvC+8","lib/tools":"AjqgZI","models/user":"QAloAk"}],sZ0N3q:[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={name:"SearchPage",active:!1,visible:!1,input:document.getElementById("search-input"),listType:"tile",navigation:"horizontal"},e.call(this,n.defaults(a,this.defaults)),this.input=new h({name:"SearchBox",handle:this.input,activated:!1,events:{change:function(a){clearTimeout(b.changeTimeout),b.changeTimeout=setTimeout(function(){b.search(a)},500)}}}),this.addComponent(this.listPanel=new k({owner:this,handle:document.getElementById("search-list-panel"),active:!1,activated:!1,components:[this.multList=new f({name:"SearchMultiColumnList",arrows:null,active:!1,activated:!0,visible:!1,handle:document.getElementById("search-multicolumn-list"),collectionType:j,collection:{url:m.get("apiUrl")+"/search",params:{query:"",from:0,to:19},events:{request:function(){this.setParameter("from",0),this.setParameter("to",19),b.multList.hide()},fetch:function(a){b.verticalList.collection.models(a),a.length>0?b.showList():b.hideList()}},clear:function(){i.prototype.clear.call(this),this.owner.activeChild=null}},collectionHandle:document.getElementById("search-multicolumn-collection"),events:{enter:function(a){b.manager.showDetails(a)}},show:function(){this.handle.classList.remove("invisible"),b.verticalList.hide(),this.activated=!0,this.activate()},hide:function(){this.handle.classList.add("invisible"),this.deactivate(),this.activated=!1},next:function(a,b){return this.activeChild.view.handle.offsetLeft>=this.itemWidth*(this.hItems-1)&&!b?null:f.prototype.next.call(this,a,b)}}),this.verticalList=new g({name:"SearchMultiColumnList",arrows:null,active:!1,activated:!1,visible:!1,handle:document.getElementById("search-vertical-list"),collectionType:j,collection:{url:m.get("apiUrl")+"/search",params:{query:""},clear:function(){i.prototype.clear.call(this),this.owner.activeChild=null}},collectionHandle:document.getElementById("search-vertical-collection"),events:{enter:function(a){b.manager.showDetails(a)}},show:function(){this.handle.classList.remove("invisible"),b.multList.hide(),this.activated=!0,this.activate()},hide:function(){this.handle.classList.add("invisible"),this.deactivate(),this.activated=!1}})]})),this.addComponent(this.keyboard=new l({active:!0,input:this.input,handle:document.getElementById("search-keyboard")})),this.on("show",function(){this.header.setTitle("Поиск"),this.keyboard.activate(),this.input.focus(),this.initFooter()}),this.on("hide",function(){this.input.handle.value="",this.verticalList.hide(),this.multList.hide()})}var e=a("lib/cpage"),f=a("components/mclist"),g=a("components/vlist"),h=a("components/input"),i=a("lib/collection"),j=a("collections/films"),k=a("lib/cpanel"),l=a("components/keyboard"),m=a("../config"),n=a("lib/tools"),o=a("lib/keys");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.search=function(a){a?(this.multList.collection.setParameter("query",encodeURIComponent(a)),this.multList.collection.fetch()):this.hideList()},d.prototype.showList=function(){return 0===this.multList.collection.length?(this.hideList(),void this.footer.hideButton("frame")):("tile"===this.listType?(this.multList.show(),this.footer.setTitle("frame","Показать текст")):(this.verticalList.show(),this.footer.setTitle("frame","Показать обложки")),this.listPanel.activated=!0,void this.footer.showButton("frame"))},d.prototype.initFooter=function(){this.footer.hideAll(),this.footer.showButton("exit","Назад")},d.prototype.hideList=function(){this.listPanel.activated=!1,this.multList.hide(),this.verticalList.hide(),this.footer.hideButton("frame")},d.prototype.eventHandler=function(a){if(e.prototype.eventHandler.call(this,a))return!0;switch(a.code){case o.FRAME:return this.listType="tile"===this.listType?"text":"tile",this.showList(),!0}return!1},b.exports=d},{"../config":40,"collections/films":"MRwP1A","components/input":"7zX6co","components/keyboard":"A64hEq","components/mclist":"mKkleD","components/vlist":"CJRc+3","lib/collection":"Ou0jNv","lib/cpage":"B6eAZ7","lib/cpanel":"ySbxUr","lib/keys":"iIRFqq","lib/tools":"AjqgZI"}],"pages/search":[function(a,b,c){b.exports=a("sZ0N3q")},{}],"K/khU5":[function(a,b,c){"use strict";function d(a){var b=this;this.defaults={name:"SortedPage",active:!1,visible:!1,modelType:f,dynamic:!0,model:{}},e.call(this,i.defaults(a,this.defaults)),this.addComponent(this.multList=new h({name:"SearchMultiColumnList",arrows:null,active:!0,handle:document.getElementById("sorted-multicolumn-list"),collectionType:g,collectionHandle:document.getElementById("sorted-multicolumn-collection"),events:{enter:function(a){b.manager.showDetails(a)},fetch:function(){b.endAction()},activateItem:function(a){b.quickInfo.update(a)}}})),this.on("show",function(){b.quickInfo.activated=!1,b.quickInfo.view.show(),this.header.setTitle(this.model.get("title"))}),this.on("hide",function(){b.quickInfo.hide(),b.quickInfo.activated=!0})}var e=a("lib/cpage"),f=a("models/film.info"),g=a("collections/films"),h=a("components/mcflist"),i=a("lib/tools");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.prepare=function(a){this.startAction(),this.model.setAll(a),this.multList.collection.fullClear(),this.multList.activeChild=null,this.multList.collection.setParameters({indent:12,sort:a.sort}),this.header.setTitle(a.title),this.multList.collection.fetch()},b.exports=d},{"collections/films":"MRwP1A","components/mcflist":"gQ4GYy","lib/cpage":"B6eAZ7","lib/tools":"AjqgZI","models/film.info":"7L3aGG"}],"pages/sorted":[function(a,b,c){b.exports=a("K/khU5")},{}]},{},[42]);
